2025-11-19 15:22:46,006 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset.csv
2025-11-19 15:22:46,006 - read - INFO - Reading CSV file from data/healthcare_dataset.csv
2025-11-19 15:22:46,315 - read - INFO - Successfully read CSV: 55500 rows x 15 columns
2025-11-19 15:22:46,315 - clean - INFO - Starting clean(): input df has 55500 rows x 15 columns
2025-11-19 15:22:46,332 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-19 15:22:46,341 - clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-19 15:22:46,789 - clean - INFO - Standardized string columns where present.
2025-11-19 15:22:46,879 - clean - INFO - Column age converted to numeric successfully.
2025-11-19 15:22:47,030 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-19 15:22:47,131 - clean - INFO - Column room_number converted to numeric successfully.
2025-11-19 15:22:47,131 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-19 15:22:47,163 - clean - INFO - Column date_of_admission parsed as datetime successfully.
2025-11-19 15:22:47,182 - clean - INFO - Column discharge_date parsed as datetime successfully.
2025-11-19 15:22:47,183 - clean - INFO - clean() completed. Output df has 55500 rows x 15 columns
2025-11-19 15:22:47,187 - transform - INFO - Starting transform(): input df has 55500 rows x 15 columns
2025-11-19 15:22:47,428 - transform - INFO - Built people_df: 54944 rows x 5 columns
2025-11-19 15:22:47,492 - transform - INFO - Built doctors_df (pre-hospital merge): 50000 rows x 3 columns
2025-11-19 15:22:47,509 - transform - INFO - Built hospitals_df: 39876 rows x 2 columns
2025-11-19 15:22:47,576 - transform - INFO - Updated doctors_df after hospital merge: 50000 rows x 4 columns
2025-11-19 15:22:47,586 - transform - INFO - Built conditions_df: 6 rows x 2 columns
2025-11-19 15:22:47,599 - transform - INFO - Built insurance_df: 5 rows x 2 columns
2025-11-19 15:22:47,628 - transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-11-19 15:22:47,639 - transform - INFO - Built admission_types_df: 3 rows x 2 columns
2025-11-19 15:22:47,639 - transform - INFO - Merging people into base df...
2025-11-19 15:22:47,875 - transform - INFO - Merging doctors into base df...
2025-11-19 15:22:47,960 - transform - INFO - Merging conditions into base df...
2025-11-19 15:22:48,025 - transform - INFO - Merging insurance into base df...
2025-11-19 15:22:48,128 - transform - INFO - Merging test_results into base df...
2025-11-19 15:22:48,224 - transform - INFO - Merging admission_types into base df...
2025-11-19 15:22:48,370 - transform - INFO - Finished merges; df is now 55500 rows x 27 columns
2025-11-19 15:22:48,389 - transform - INFO - Built admissions_df: 55500 rows x 12 columns
2025-11-19 15:22:48,409 - transform - INFO - transform() completed successfully. Output tables: {'people': (54944, 5), 'doctors': (50000, 4), 'hospitals': (39876, 2), 'conditions': (6, 2), 'insurance': (5, 2), 'admission_types': (3, 2), 'test_results': (3, 2), 'admissions': (55500, 12)}
2025-11-19 15:22:48,435 - load - INFO - Starting load()
2025-11-19 15:22:48,436 - load - INFO - Row counts - people=54944, hospitals=39876, doctors=50000, conditions=6, insurance=5, test_results=3, admission_types=3, admissions=55500
2025-11-19 15:22:48,436 - load - INFO - Connecting to database...
2025-11-19 15:22:48,757 - load - INFO - Database connection established.
2025-11-19 15:22:48,757 - load - INFO - Creating tables if they do not exist...
2025-11-19 15:22:48,759 - load - INFO - Tables created/verified successfully.
2025-11-19 15:22:48,759 - load - INFO - Truncating tables and resetting identities...
2025-11-19 15:22:48,837 - load - INFO - Tables truncated.
2025-11-19 15:22:48,837 - load - INFO - Inserting into people...
2025-11-19 15:22:59,819 - load - INFO - Inserting into hospitals...
2025-11-19 15:23:10,692 - load - INFO - Inserting into doctors...
2025-11-19 15:23:23,679 - load - INFO - Inserting into conditions...
2025-11-19 15:23:23,685 - load - INFO - Inserting into insurance...
2025-11-19 15:23:23,688 - load - INFO - Inserting into test_results...
2025-11-19 15:23:23,692 - load - INFO - Inserting into admission_types...
2025-11-19 15:23:23,694 - load - INFO - Inserting into admission_data...
2025-11-19 15:23:41,367 - load - INFO - Load completed successfully.
2025-11-19 15:23:41,367 - load - INFO - Database connection closed. End of load().
2025-11-25 11:29:52,845 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 11:29:52,846 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 11:29:53,300 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 11:29:53,300 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 11:29:53,315 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 11:29:53,339 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 11:29:53,803 - clean - INFO - Standardized string columns where present.
2025-11-25 11:29:53,866 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 11:29:54,070 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 11:29:54,123 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 11:29:54,124 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 11:29:54,150 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 11:29:54,174 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 11:29:54,174 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 11:29:54,174 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 11:29:54,224 - transform - INFO - Built people_df: 55144 rows x 5 columns
2025-11-25 11:29:54,278 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 11:29:54,292 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 11:29:54,435 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 11:29:54,445 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 11:29:54,450 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 11:29:54,456 - transform - INFO - Built test_results_df: 4 rows x 2 columns
2025-11-25 11:29:54,500 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 11:29:54,504 - transform - INFO - Merging people into base df...
2025-11-25 11:29:54,738 - transform - INFO - Merging doctors into base df...
2025-11-25 11:29:54,812 - transform - INFO - Merging conditions into base df...
2025-11-25 11:29:54,935 - transform - INFO - Merging insurance into base df...
2025-11-25 11:29:55,082 - transform - INFO - Merging test_results into base df...
2025-11-25 11:29:55,136 - transform - INFO - Merging admission_types into base df...
2025-11-25 11:29:55,249 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 11:29:55,288 - transform - INFO - Built admissions_df: 57165 rows x 12 columns
2025-11-25 11:29:56,733 - transform - INFO - After reject split: 41576 valid admissions, 15589 rejected rows
2025-11-25 11:29:56,733 - transform - INFO - transform() completed successfully. Output tables: {'people': (55144, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (4, 2), 'admissions': (41576, 12), 'rejects': (15589, 13)}
2025-11-25 11:29:56,754 - load - INFO - Starting load()
2025-11-25 11:29:56,754 - load - INFO - Row counts - people=55144, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=4, admission_types=4, admissions=41576, rejects=15589
2025-11-25 11:29:56,754 - load - INFO - Connecting to database...
2025-11-25 11:29:56,776 - load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 37, in load
    conn = psycopg2.connect(db_url)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/psycopg2/__init__.py", line 121, in connect
    dsn = _ext.make_dsn(dsn, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/psycopg2/extensions.py", line 145, in make_dsn
    parse_dsn(dsn)
psycopg2.ProgrammingError: invalid dsn: missing "=" after "${DB_URL}" in connection info string

2025-11-25 11:29:56,815 - load - INFO - Database connection closed. End of load().
2025-11-25 11:35:48,526 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 11:35:48,526 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 11:35:48,815 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 11:35:48,815 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 11:35:48,830 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 11:35:48,838 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 11:35:49,362 - clean - INFO - Standardized string columns where present.
2025-11-25 11:35:49,405 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 11:35:49,544 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 11:35:49,604 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 11:35:49,607 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 11:35:49,672 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 11:35:49,729 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 11:35:49,731 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 11:35:49,734 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 11:35:50,515 - transform - INFO - Built people_df: 55144 rows x 5 columns
2025-11-25 11:35:50,557 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 11:35:50,563 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 11:35:50,600 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 11:35:50,610 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 11:35:50,615 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 11:35:50,631 - transform - INFO - Built test_results_df: 4 rows x 2 columns
2025-11-25 11:35:50,675 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 11:35:50,729 - transform - INFO - Merging people into base df...
2025-11-25 11:35:50,853 - transform - INFO - Merging doctors into base df...
2025-11-25 11:35:50,977 - transform - INFO - Merging conditions into base df...
2025-11-25 11:35:51,198 - transform - INFO - Merging insurance into base df...
2025-11-25 11:35:51,285 - transform - INFO - Merging test_results into base df...
2025-11-25 11:35:51,383 - transform - INFO - Merging admission_types into base df...
2025-11-25 11:35:51,503 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 11:35:51,546 - transform - INFO - Built admissions_df: 57165 rows x 12 columns
2025-11-25 11:35:53,586 - transform - INFO - After reject split: 41576 valid admissions, 15589 rejected rows
2025-11-25 11:35:53,587 - transform - INFO - transform() completed successfully. Output tables: {'people': (55144, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (4, 2), 'admissions': (41576, 12), 'rejects': (15589, 13)}
2025-11-25 11:35:53,592 - load - INFO - Starting load()
2025-11-25 11:35:53,592 - load - INFO - Row counts - people=55144, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=4, admission_types=4, admissions=41576, rejects=15589
2025-11-25 11:35:53,592 - load - INFO - Connecting to database...
2025-11-25 11:35:53,829 - load - INFO - Database connection established.
2025-11-25 11:35:53,829 - load - INFO - Creating tables if they do not exist...
2025-11-25 11:35:54,187 - load - INFO - Tables created/verified successfully.
2025-11-25 11:35:54,188 - load - INFO - Truncating tables and resetting identities...
2025-11-25 11:35:54,595 - load - INFO - Tables truncated.
2025-11-25 11:35:54,596 - load - INFO - Inserting into people...
2025-11-25 11:35:54,643 - load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 153, in load
    cur.execute(
psycopg2.errors.NumericValueOutOfRange: integer out of range

2025-11-25 11:35:54,645 - load - INFO - Transaction rolled back due to error.
2025-11-25 11:35:54,645 - load - INFO - Database connection closed. End of load().
2025-11-25 11:47:47,946 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 11:47:47,946 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 11:47:48,233 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 11:47:48,233 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 11:47:48,251 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 11:47:48,265 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 11:47:48,840 - clean - INFO - Standardized string columns where present.
2025-11-25 11:47:48,905 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 11:47:48,907 - clean - WARNING - Age: 144 value(s) outside valid range; setting to NA
2025-11-25 11:47:48,913 - clean - ERROR - clean() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/clean.py", line 96, in clean
    (df["room_number"] < 0) | (df["room_number"] > 100000)
     ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/ops/common.py", line 76, in new_method
    return method(self, other)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/arraylike.py", line 48, in __lt__
    return self._cmp_method(other, operator.lt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/series.py", line 6138, in _cmp_method
    res_values = ops.comparison_op(lvalues, rvalues, op)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 344, in comparison_op
    res_values = comp_method_OBJECT_ARRAY(op, lvalues, rvalues)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/ops/array_ops.py", line 129, in comp_method_OBJECT_ARRAY
    result = libops.scalar_compare(x.ravel(), y, op)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/ops.pyx", line 107, in pandas._libs.ops.scalar_compare
TypeError: '<' not supported between instances of 'str' and 'int'
2025-11-25 11:50:09,054 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 11:50:09,058 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 11:50:09,404 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 11:50:09,404 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 11:50:09,418 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 11:50:09,432 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 11:50:09,936 - clean - INFO - Standardized string columns where present.
2025-11-25 11:50:09,974 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 11:50:09,978 - clean - WARNING - Age: 144 value(s) outside valid range; setting to NA
2025-11-25 11:50:09,979 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 11:50:10,088 - clean - INFO - Age range before validation: min=0.0, max=89.0
2025-11-25 11:50:10,089 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 11:50:10,127 - clean - INFO - Age range before validation: min=0.0, max=89.0
2025-11-25 11:50:10,128 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 11:50:10,128 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 11:50:10,166 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 11:50:10,181 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 11:50:10,181 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 11:50:10,181 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 11:50:10,375 - transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 11:50:10,421 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 11:50:10,429 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 11:50:10,476 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 11:50:10,487 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 11:50:10,497 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 11:50:10,510 - transform - INFO - Built test_results_df: 4 rows x 2 columns
2025-11-25 11:50:10,528 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 11:50:10,530 - transform - INFO - Merging people into base df...
2025-11-25 11:50:10,664 - transform - INFO - Merging doctors into base df...
2025-11-25 11:50:10,962 - transform - INFO - Merging conditions into base df...
2025-11-25 11:50:11,079 - transform - INFO - Merging insurance into base df...
2025-11-25 11:50:11,143 - transform - INFO - Merging test_results into base df...
2025-11-25 11:50:11,230 - transform - INFO - Merging admission_types into base df...
2025-11-25 11:50:11,321 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 11:50:11,338 - transform - INFO - Built admissions_df: 57165 rows x 12 columns
2025-11-25 11:50:12,765 - transform - INFO - After reject split: 41576 valid admissions, 15589 rejected rows
2025-11-25 11:50:12,765 - transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (4, 2), 'admissions': (41576, 12), 'rejects': (15589, 13)}
2025-11-25 11:50:12,771 - load - INFO - Starting load()
2025-11-25 11:50:12,771 - load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=4, admission_types=4, admissions=41576, rejects=15589
2025-11-25 11:50:12,771 - load - INFO - Connecting to database...
2025-11-25 11:50:12,989 - load - INFO - Database connection established.
2025-11-25 11:50:12,989 - load - INFO - Creating tables if they do not exist...
2025-11-25 11:50:13,000 - load - INFO - Tables created/verified successfully.
2025-11-25 11:50:13,000 - load - INFO - Truncating tables and resetting identities...
2025-11-25 11:50:13,122 - load - INFO - Tables truncated.
2025-11-25 11:50:13,122 - load - INFO - Inserting into people...
2025-11-25 11:50:13,157 - load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 153, in load
    cur.execute(
psycopg2.errors.NumericValueOutOfRange: integer out of range

2025-11-25 11:50:13,167 - load - INFO - Transaction rolled back due to error.
2025-11-25 11:50:13,167 - load - INFO - Database connection closed. End of load().
2025-11-25 11:54:27,593 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 11:54:27,594 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 11:54:28,196 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 11:54:28,197 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 11:54:28,211 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 11:54:28,229 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 11:54:28,780 - clean - INFO - Standardized string columns where present.
2025-11-25 11:54:28,819 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 11:54:28,922 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 11:54:28,976 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 11:54:28,979 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 11:54:28,981 - clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 11:54:28,982 - clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 11:54:29,005 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 11:54:29,182 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 11:54:29,197 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 11:54:29,197 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 11:54:29,198 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 11:54:29,256 - transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 11:54:29,299 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 11:54:29,308 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 11:54:29,336 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 11:54:29,349 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 11:54:29,355 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 11:54:29,365 - transform - INFO - Built test_results_df: 4 rows x 2 columns
2025-11-25 11:54:29,412 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 11:54:29,412 - transform - INFO - Merging people into base df...
2025-11-25 11:54:29,498 - transform - INFO - Merging doctors into base df...
2025-11-25 11:54:29,568 - transform - INFO - Merging conditions into base df...
2025-11-25 11:54:29,621 - transform - INFO - Merging insurance into base df...
2025-11-25 11:54:29,672 - transform - INFO - Merging test_results into base df...
2025-11-25 11:54:29,723 - transform - INFO - Merging admission_types into base df...
2025-11-25 11:54:29,789 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 11:54:29,801 - transform - INFO - Built admissions_df: 57165 rows x 12 columns
2025-11-25 11:54:31,338 - transform - INFO - After reject split: 41576 valid admissions, 15589 rejected rows
2025-11-25 11:54:31,338 - transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (4, 2), 'admissions': (41576, 12), 'rejects': (15589, 13)}
2025-11-25 11:54:31,345 - load - INFO - Starting load()
2025-11-25 11:54:31,345 - load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=4, admission_types=4, admissions=41576, rejects=15589
2025-11-25 11:54:31,345 - load - INFO - Connecting to database...
2025-11-25 11:54:31,578 - load - INFO - Database connection established.
2025-11-25 11:54:31,578 - load - INFO - Creating tables if they do not exist...
2025-11-25 11:54:31,608 - load - INFO - Tables created/verified successfully.
2025-11-25 11:54:31,608 - load - INFO - Truncating tables and resetting identities...
2025-11-25 11:54:31,688 - load - INFO - Tables truncated.
2025-11-25 11:54:31,688 - load - INFO - Inserting into people...
2025-11-25 11:54:31,726 - load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 153, in load
    cur.execute(
psycopg2.errors.NumericValueOutOfRange: integer out of range

2025-11-25 11:54:31,729 - load - INFO - Transaction rolled back due to error.
2025-11-25 11:54:31,730 - load - INFO - Database connection closed. End of load().
2025-11-25 12:00:55,370 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 12:00:55,370 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 12:00:55,641 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 12:00:55,641 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 12:00:55,664 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 12:00:55,692 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 12:00:56,260 - clean - INFO - Standardized string columns where present.
2025-11-25 12:00:56,298 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 12:00:56,404 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 12:00:56,456 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 12:00:56,457 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 12:00:56,459 - clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 12:00:56,469 - clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 12:00:56,472 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 12:00:56,541 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 12:00:56,568 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 12:00:56,569 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 12:00:56,570 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 12:00:56,730 - transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 12:00:56,874 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 12:00:56,900 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 12:00:56,935 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 12:00:56,949 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 12:00:56,976 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 12:00:56,985 - transform - INFO - Built test_results_df: 4 rows x 2 columns
2025-11-25 12:00:57,003 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 12:00:57,004 - transform - INFO - Merging people into base df...
2025-11-25 12:00:57,142 - transform - INFO - Merging doctors into base df...
2025-11-25 12:00:57,202 - transform - INFO - Merging conditions into base df...
2025-11-25 12:00:57,251 - transform - INFO - Merging insurance into base df...
2025-11-25 12:00:57,308 - transform - INFO - Merging test_results into base df...
2025-11-25 12:00:57,400 - transform - INFO - Merging admission_types into base df...
2025-11-25 12:00:57,474 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 12:00:57,485 - transform - INFO - Built admissions_df: 57165 rows x 12 columns
2025-11-25 12:00:58,900 - transform - INFO - After reject split: 41576 valid admissions, 15589 rejected rows
2025-11-25 12:00:58,900 - transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (4, 2), 'admissions': (41576, 12), 'rejects': (15589, 13)}
2025-11-25 12:00:58,906 - load - INFO - Starting load()
2025-11-25 12:00:58,906 - load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=4, admission_types=4, admissions=41576, rejects=15589
2025-11-25 12:00:58,906 - load - INFO - Connecting to database...
2025-11-25 12:00:59,009 - load - INFO - Database connection established.
2025-11-25 12:00:59,009 - load - INFO - Creating tables if they do not exist...
2025-11-25 12:00:59,012 - load - INFO - Tables created/verified successfully.
2025-11-25 12:00:59,013 - load - INFO - Truncating tables and resetting identities...
2025-11-25 12:00:59,106 - load - INFO - Tables truncated.
2025-11-25 12:00:59,106 - load - INFO - Inserting into people...
2025-11-25 12:01:07,157 - load - INFO - Inserting into hospitals...
2025-11-25 12:01:11,856 - load - INFO - Inserting into doctors...
2025-11-25 12:01:33,942 - load - INFO - Inserting into conditions...
2025-11-25 12:01:34,016 - load - INFO - Inserting into insurance...
2025-11-25 12:01:34,039 - load - INFO - Inserting into test_results...
2025-11-25 12:01:34,090 - load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 224, in load
    cur.execute(
psycopg2.errors.CheckViolation: new row for relation "test_results" violates check constraint "test_results_result_label_check"
DETAIL:  Failing row contains (1, NaN).

2025-11-25 12:01:34,138 - load - INFO - Transaction rolled back due to error.
2025-11-25 12:01:34,139 - load - INFO - Database connection closed. End of load().
2025-11-25 12:21:36,354 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 12:21:36,354 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 12:21:36,627 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 12:21:36,627 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 12:21:36,642 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 12:21:36,652 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 12:21:37,214 - clean - INFO - Standardized string columns where present.
2025-11-25 12:21:37,244 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 12:21:37,509 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 12:21:37,540 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 12:21:37,541 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 12:21:37,542 - clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 12:21:37,543 - clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 12:21:37,544 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 12:21:37,565 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 12:21:37,586 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 12:21:37,586 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 12:21:37,586 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 12:21:37,631 - transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 12:21:37,683 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 12:21:37,698 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 12:21:37,734 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 12:21:37,749 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 12:21:37,759 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 12:21:37,768 - transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-11-25 12:21:37,787 - transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-11-25 12:21:37,800 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 12:21:37,802 - transform - INFO - Merging people into base df...
2025-11-25 12:21:38,018 - transform - INFO - Merging doctors into base df...
2025-11-25 12:21:38,093 - transform - INFO - Merging conditions into base df...
2025-11-25 12:21:38,166 - transform - INFO - Merging insurance into base df...
2025-11-25 12:21:38,248 - transform - INFO - Merging test_results into base df...
2025-11-25 12:21:38,315 - transform - INFO - Merging admission_types into base df...
2025-11-25 12:21:38,392 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 12:21:38,401 - transform - INFO - Built admissions_df: 57165 rows x 12 columns
2025-11-25 12:21:40,005 - transform - INFO - After reject split: 39539 valid admissions, 17626 rejected rows
2025-11-25 12:21:40,005 - transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (3, 2), 'admissions': (39539, 12), 'rejects': (17626, 13)}
2025-11-25 12:21:40,014 - load - INFO - Starting load()
2025-11-25 12:21:40,014 - load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=3, admission_types=4, admissions=39539, rejects=17626
2025-11-25 12:21:40,014 - load - INFO - Connecting to database...
2025-11-25 12:21:40,156 - load - INFO - Database connection established.
2025-11-25 12:21:40,156 - load - INFO - Creating tables if they do not exist...
2025-11-25 12:21:40,250 - load - INFO - Tables created/verified successfully.
2025-11-25 12:21:40,250 - load - INFO - Truncating tables and resetting identities...
2025-11-25 12:21:40,504 - load - INFO - Tables truncated.
2025-11-25 12:21:40,504 - load - INFO - Inserting into people...
2025-11-25 12:21:48,082 - load - INFO - Inserting into hospitals...
2025-11-25 12:21:52,433 - load - INFO - Inserting into doctors...
2025-11-25 12:22:00,719 - load - INFO - Inserting into conditions...
2025-11-25 12:22:00,724 - load - INFO - Inserting into insurance...
2025-11-25 12:22:00,727 - load - INFO - Inserting into test_results...
2025-11-25 12:22:00,748 - load - INFO - Inserting into admission_types...
2025-11-25 12:22:00,762 - load - INFO - Inserting into admission_data...
2025-11-25 12:22:13,073 - load - INFO - Inserting into rejects...
2025-11-25 12:22:13,104 - load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 280, in load
    cur.execute(
psycopg2.errors.NumericValueOutOfRange: integer out of range

2025-11-25 12:22:13,129 - load - INFO - Transaction rolled back due to error.
2025-11-25 12:22:13,129 - load - INFO - Database connection closed. End of load().
2025-11-25 13:01:39,602 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 13:01:39,602 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 13:01:39,957 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 13:01:39,957 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 13:01:39,976 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:01:40,013 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:01:41,454 - clean - INFO - Standardized string columns where present.
2025-11-25 13:01:41,514 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:01:41,790 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 13:01:41,887 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:01:41,976 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 13:01:42,010 - clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 13:01:42,012 - clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 13:01:42,046 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 13:01:42,174 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:01:42,228 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:01:42,230 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 13:01:42,231 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 13:01:42,371 - transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 13:01:42,437 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 13:01:42,445 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 13:01:42,513 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 13:01:42,523 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 13:01:42,586 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 13:01:42,597 - transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-11-25 13:01:42,607 - transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-11-25 13:01:42,617 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 13:01:42,617 - transform - INFO - Merging people into base df...
2025-11-25 13:01:42,708 - transform - INFO - Merging doctors into base df...
2025-11-25 13:01:42,794 - transform - INFO - Merging conditions into base df...
2025-11-25 13:01:42,995 - transform - INFO - Merging insurance into base df...
2025-11-25 13:01:43,149 - transform - INFO - Merging test_results into base df...
2025-11-25 13:01:43,298 - transform - INFO - Merging admission_types into base df...
2025-11-25 13:01:43,460 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 13:01:45,275 - transform - INFO - Built admissions_df: 39539 rows x 12 columns
2025-11-25 13:01:45,275 - transform - INFO - After reject split: 39539 valid admissions, 17626 rejected rows
2025-11-25 13:01:45,275 - transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (3, 2), 'admissions': (39539, 12), 'rejects': (17626, 16)}
2025-11-25 13:01:45,281 - load - INFO - Starting load()
2025-11-25 13:01:45,281 - load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=3, admission_types=4, admissions=39539, rejects=17626
2025-11-25 13:01:45,281 - load - INFO - Connecting to database...
2025-11-25 13:01:46,454 - load - INFO - Database connection established.
2025-11-25 13:01:46,454 - load - INFO - Creating tables if they do not exist...
2025-11-25 13:01:46,614 - load - INFO - Tables created/verified successfully.
2025-11-25 13:01:46,614 - load - INFO - Truncating tables and resetting identities...
2025-11-25 13:01:46,962 - load - INFO - Tables truncated.
2025-11-25 13:01:46,962 - load - INFO - Inserting into people...
2025-11-25 13:01:54,382 - load - INFO - Inserting into hospitals...
2025-11-25 13:01:58,642 - load - INFO - Inserting into doctors...
2025-11-25 13:02:08,544 - load - INFO - Inserting into conditions...
2025-11-25 13:02:08,546 - load - INFO - Inserting into insurance...
2025-11-25 13:02:08,551 - load - INFO - Inserting into test_results...
2025-11-25 13:02:08,577 - load - INFO - Inserting into admission_types...
2025-11-25 13:02:08,594 - load - INFO - Inserting into admission_data...
2025-11-25 13:02:19,509 - load - INFO - Inserting into rejects...
2025-11-25 13:02:19,529 - load - INFO - Database connection closed. End of load().
2025-11-25 13:08:04,806 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 13:08:04,806 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 13:08:05,249 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 13:08:05,250 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 13:08:05,266 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:08:05,285 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:08:05,866 - clean - INFO - Standardized string columns where present.
2025-11-25 13:08:05,899 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:08:05,988 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 13:08:06,017 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:08:06,018 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 13:08:06,020 - clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 13:08:06,022 - clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 13:08:06,023 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 13:08:06,047 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:08:06,063 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:08:06,064 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 13:08:06,064 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 13:08:06,160 - transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 13:08:06,191 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 13:08:06,200 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 13:08:06,275 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 13:08:06,284 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 13:08:06,303 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 13:08:06,342 - transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-11-25 13:08:06,359 - transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-11-25 13:08:06,365 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 13:08:06,365 - transform - INFO - Merging people into base df...
2025-11-25 13:08:06,479 - transform - INFO - Merging doctors into base df...
2025-11-25 13:08:06,552 - transform - INFO - Merging conditions into base df...
2025-11-25 13:08:06,590 - transform - INFO - Merging insurance into base df...
2025-11-25 13:08:06,635 - transform - INFO - Merging test_results into base df...
2025-11-25 13:08:06,699 - transform - INFO - Merging admission_types into base df...
2025-11-25 13:08:06,777 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 13:08:08,315 - transform - INFO - Built admissions_df: 39539 rows x 12 columns
2025-11-25 13:08:08,315 - transform - INFO - After reject split: 39539 valid admissions, 17626 rejected rows
2025-11-25 13:08:08,316 - transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (3, 2), 'admissions': (39539, 12), 'rejects': (17626, 16)}
2025-11-25 13:08:08,327 - load - INFO - Starting load()
2025-11-25 13:08:08,327 - load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=3, admission_types=4, admissions=39539, rejects=17626
2025-11-25 13:08:08,327 - load - INFO - Connecting to database...
2025-11-25 13:08:08,444 - load - INFO - Database connection established.
2025-11-25 13:08:08,444 - load - INFO - Creating tables if they do not exist...
2025-11-25 13:08:08,460 - load - INFO - Tables created/verified successfully.
2025-11-25 13:08:08,460 - load - INFO - Truncating tables and resetting identities...
2025-11-25 13:08:08,536 - load - INFO - Tables truncated.
2025-11-25 13:08:08,536 - load - INFO - Inserting into people...
2025-11-25 13:08:15,756 - load - INFO - Inserting into hospitals...
2025-11-25 13:08:20,535 - load - INFO - Inserting into doctors...
2025-11-25 13:08:27,507 - load - INFO - Inserting into conditions...
2025-11-25 13:08:27,512 - load - INFO - Inserting into insurance...
2025-11-25 13:08:27,533 - load - INFO - Inserting into test_results...
2025-11-25 13:08:27,536 - load - INFO - Inserting into admission_types...
2025-11-25 13:08:27,571 - load - INFO - Inserting into admission_data...
2025-11-25 13:08:39,085 - load - INFO - Inserting into rejects...
2025-11-25 13:08:39,164 - load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 283, in load
    cur.execute(
psycopg2.errors.UndefinedColumn: column "name" of relation "rejects" does not exist
LINE 3:                     name,
                            ^

2025-11-25 13:08:39,168 - load - INFO - Transaction rolled back due to error.
2025-11-25 13:08:39,168 - load - INFO - Database connection closed. End of load().
2025-11-25 13:13:37,377 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 13:13:37,377 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 13:13:37,634 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 13:13:37,634 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 13:13:37,666 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:13:37,686 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:13:38,123 - clean - INFO - Standardized string columns where present.
2025-11-25 13:13:38,219 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:13:38,404 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 13:13:38,435 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:13:38,436 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 13:13:38,437 - clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 13:13:38,438 - clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 13:13:38,439 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 13:13:38,463 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:13:38,480 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:13:38,480 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 13:13:38,480 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 13:13:38,537 - transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 13:13:38,578 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 13:13:38,591 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 13:13:38,666 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 13:13:38,672 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 13:13:38,688 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 13:13:38,791 - transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-11-25 13:13:38,836 - transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-11-25 13:13:38,845 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 13:13:38,845 - transform - INFO - Merging people into base df...
2025-11-25 13:13:38,954 - transform - INFO - Merging doctors into base df...
2025-11-25 13:13:39,025 - transform - INFO - Merging conditions into base df...
2025-11-25 13:13:39,097 - transform - INFO - Merging insurance into base df...
2025-11-25 13:13:39,183 - transform - INFO - Merging test_results into base df...
2025-11-25 13:13:39,265 - transform - INFO - Merging admission_types into base df...
2025-11-25 13:13:39,331 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 13:13:41,232 - transform - INFO - Built admissions_df: 39539 rows x 12 columns
2025-11-25 13:13:41,232 - transform - INFO - After reject split: 39539 valid admissions, 17626 rejected rows
2025-11-25 13:13:41,232 - transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (3, 2), 'admissions': (39539, 12), 'rejects': (17626, 16)}
2025-11-25 13:13:41,238 - load - INFO - Starting load()
2025-11-25 13:13:41,238 - load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=3, admission_types=4, admissions=39539, rejects=17626
2025-11-25 13:13:41,238 - load - INFO - Connecting to database...
2025-11-25 13:13:41,355 - load - INFO - Database connection established.
2025-11-25 13:13:41,356 - load - INFO - Creating tables if they do not exist...
2025-11-25 13:13:41,374 - load - INFO - Tables created/verified successfully.
2025-11-25 13:13:41,375 - load - INFO - Truncating tables and resetting identities...
2025-11-25 13:13:41,462 - load - INFO - Tables truncated.
2025-11-25 13:13:41,463 - load - INFO - Inserting into people...
2025-11-25 13:13:49,486 - load - INFO - Inserting into hospitals...
2025-11-25 13:13:53,919 - load - INFO - Inserting into doctors...
2025-11-25 13:14:04,167 - load - INFO - Inserting into conditions...
2025-11-25 13:14:04,173 - load - INFO - Inserting into insurance...
2025-11-25 13:14:04,193 - load - INFO - Inserting into test_results...
2025-11-25 13:14:04,196 - load - INFO - Inserting into admission_types...
2025-11-25 13:14:04,200 - load - INFO - Inserting into admission_data...
2025-11-25 13:14:16,420 - load - INFO - Inserting into rejects...
2025-11-25 13:14:16,508 - load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 283, in load
    cur.execute(
psycopg2.errors.UndefinedColumn: column "name" of relation "rejects" does not exist
LINE 3:                     name,
                            ^

2025-11-25 13:14:16,556 - load - INFO - Transaction rolled back due to error.
2025-11-25 13:14:16,557 - load - INFO - Database connection closed. End of load().
2025-11-25 13:16:42,004 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 13:16:42,005 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 13:16:43,015 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 13:16:43,015 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 13:16:43,031 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:16:43,155 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:16:43,924 - clean - INFO - Standardized string columns where present.
2025-11-25 13:16:43,965 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:16:44,113 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 13:16:44,302 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:16:44,304 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 13:16:44,306 - clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 13:16:44,308 - clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 13:16:44,309 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 13:16:44,372 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:16:44,399 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:16:44,400 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 13:16:44,401 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 13:16:44,455 - transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 13:16:44,509 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 13:16:44,526 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 13:16:44,552 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 13:16:44,560 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 13:16:44,568 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 13:16:44,576 - transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-11-25 13:16:44,586 - transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-11-25 13:16:44,592 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 13:16:44,592 - transform - INFO - Merging people into base df...
2025-11-25 13:16:44,706 - transform - INFO - Merging doctors into base df...
2025-11-25 13:16:44,778 - transform - INFO - Merging conditions into base df...
2025-11-25 13:16:44,818 - transform - INFO - Merging insurance into base df...
2025-11-25 13:16:44,869 - transform - INFO - Merging test_results into base df...
2025-11-25 13:16:44,935 - transform - INFO - Merging admission_types into base df...
2025-11-25 13:16:45,010 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 13:16:46,449 - transform - INFO - Built admissions_df: 39539 rows x 12 columns
2025-11-25 13:16:46,449 - transform - INFO - After reject split: 39539 valid admissions, 17626 rejected rows
2025-11-25 13:16:46,449 - transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (3, 2), 'admissions': (39539, 12), 'rejects': (17626, 16)}
2025-11-25 13:16:46,454 - load - INFO - Starting load()
2025-11-25 13:16:46,454 - load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=3, admission_types=4, admissions=39539, rejects=17626
2025-11-25 13:16:46,454 - load - INFO - Connecting to database...
2025-11-25 13:16:46,562 - load - INFO - Database connection established.
2025-11-25 13:16:46,562 - load - INFO - Creating tables if they do not exist...
2025-11-25 13:16:46,656 - load - INFO - Tables created/verified successfully.
2025-11-25 13:16:46,656 - load - INFO - Truncating tables and resetting identities...
2025-11-25 13:16:46,700 - load - INFO - Tables truncated.
2025-11-25 13:16:46,700 - load - INFO - Inserting into people...
2025-11-25 13:16:54,627 - load - INFO - Inserting into hospitals...
2025-11-25 13:16:59,091 - load - INFO - Inserting into doctors...
2025-11-25 13:17:06,720 - load - INFO - Inserting into conditions...
2025-11-25 13:17:06,746 - load - INFO - Inserting into insurance...
2025-11-25 13:17:06,769 - load - INFO - Inserting into test_results...
2025-11-25 13:17:06,790 - load - INFO - Inserting into admission_types...
2025-11-25 13:17:06,796 - load - INFO - Inserting into admission_data...
2025-11-25 13:17:17,580 - load - INFO - Inserting into rejects...
2025-11-25 13:17:17,606 - load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 283, in load
    cur.execute(
psycopg2.errors.SyntaxError: INSERT has more target columns than expressions
LINE 19:                     missing_columns
                             ^

2025-11-25 13:17:17,626 - load - INFO - Transaction rolled back due to error.
2025-11-25 13:17:17,627 - load - INFO - Database connection closed. End of load().
2025-11-25 13:20:05,309 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 13:20:05,310 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 13:20:05,667 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 13:20:05,667 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 13:20:05,682 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:20:05,695 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:20:06,192 - clean - INFO - Standardized string columns where present.
2025-11-25 13:20:06,224 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:20:06,446 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 13:20:06,507 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:20:06,509 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 13:20:06,510 - clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 13:20:06,521 - clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 13:20:06,523 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 13:20:06,611 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:20:06,661 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:20:06,661 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 13:20:06,662 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 13:20:06,728 - transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 13:20:06,801 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 13:20:06,813 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 13:20:07,148 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 13:20:07,159 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 13:20:07,169 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 13:20:07,311 - transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-11-25 13:20:07,329 - transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-11-25 13:20:07,335 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 13:20:07,336 - transform - INFO - Merging people into base df...
2025-11-25 13:20:07,499 - transform - INFO - Merging doctors into base df...
2025-11-25 13:20:07,712 - transform - INFO - Merging conditions into base df...
2025-11-25 13:20:07,839 - transform - INFO - Merging insurance into base df...
2025-11-25 13:20:07,929 - transform - INFO - Merging test_results into base df...
2025-11-25 13:20:08,055 - transform - INFO - Merging admission_types into base df...
2025-11-25 13:20:08,160 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 13:20:09,642 - transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 224, in transform
    rejects_df = df.loc[
                 ^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexing.py", line 1185, in __getitem__
    return self._getitem_tuple(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexing.py", line 1378, in _getitem_tuple
    return self._getitem_tuple_same_dim(tup)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexing.py", line 1021, in _getitem_tuple_same_dim
    retval = getattr(retval, self.name)._getitem_axis(key, axis=i)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexing.py", line 1421, in _getitem_axis
    return self._getitem_iterable(key, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexing.py", line 1361, in _getitem_iterable
    keyarr, indexer = self._get_listlike_indexer(key, axis)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexing.py", line 1559, in _get_listlike_indexer
    keyarr, indexer = ax._get_indexer_strict(key, axis_name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['missing_columns'] not in index"
2025-11-25 13:20:29,951 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 13:20:29,952 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 13:20:30,263 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 13:20:30,263 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 13:20:30,276 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:20:30,294 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:20:30,760 - clean - INFO - Standardized string columns where present.
2025-11-25 13:20:30,820 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:20:30,915 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 13:20:30,950 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:20:30,955 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 13:20:30,956 - clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 13:20:30,957 - clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 13:20:30,958 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 13:20:31,007 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:20:31,042 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:20:31,042 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 13:20:31,043 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 13:20:31,117 - transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 13:20:31,161 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 13:20:31,180 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 13:20:31,220 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 13:20:31,318 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 13:20:31,416 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 13:20:31,477 - transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-11-25 13:20:31,531 - transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-11-25 13:20:31,539 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 13:20:31,539 - transform - INFO - Merging people into base df...
2025-11-25 13:20:31,738 - transform - INFO - Merging doctors into base df...
2025-11-25 13:20:31,808 - transform - INFO - Merging conditions into base df...
2025-11-25 13:20:31,897 - transform - INFO - Merging insurance into base df...
2025-11-25 13:20:31,974 - transform - INFO - Merging test_results into base df...
2025-11-25 13:20:32,043 - transform - INFO - Merging admission_types into base df...
2025-11-25 13:20:32,088 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 13:20:33,586 - transform - INFO - Built admissions_df: 39539 rows x 12 columns
2025-11-25 13:20:33,586 - transform - INFO - After reject split: 39539 valid admissions, 17626 rejected rows
2025-11-25 13:20:33,586 - transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (3, 2), 'admissions': (39539, 12), 'rejects': (17626, 16)}
2025-11-25 13:20:33,591 - load - INFO - Starting load()
2025-11-25 13:20:33,591 - load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=3, admission_types=4, admissions=39539, rejects=17626
2025-11-25 13:20:33,591 - load - INFO - Connecting to database...
2025-11-25 13:20:33,683 - load - INFO - Database connection established.
2025-11-25 13:20:33,684 - load - INFO - Creating tables if they do not exist...
2025-11-25 13:20:33,742 - load - INFO - Tables created/verified successfully.
2025-11-25 13:20:33,742 - load - INFO - Truncating tables and resetting identities...
2025-11-25 13:20:33,744 - load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 139, in load
    cur.execute("""
psycopg2.errors.UndefinedTable: relation "reject_id" does not exist

2025-11-25 13:20:33,753 - load - INFO - Transaction rolled back due to error.
2025-11-25 13:20:33,754 - load - INFO - Database connection closed. End of load().
2025-11-25 13:21:27,123 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 13:21:27,123 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 13:21:27,412 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 13:21:27,412 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 13:21:27,442 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:21:27,471 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:21:27,926 - clean - INFO - Standardized string columns where present.
2025-11-25 13:21:27,971 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:21:28,083 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 13:21:28,114 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:21:28,115 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 13:21:28,117 - clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 13:21:28,118 - clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 13:21:28,120 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 13:21:28,139 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:21:28,157 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:21:28,157 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 13:21:28,157 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 13:21:28,218 - transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 13:21:28,250 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 13:21:28,260 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 13:21:28,300 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 13:21:28,309 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 13:21:28,315 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 13:21:28,323 - transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-11-25 13:21:28,334 - transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-11-25 13:21:28,340 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 13:21:28,340 - transform - INFO - Merging people into base df...
2025-11-25 13:21:28,425 - transform - INFO - Merging doctors into base df...
2025-11-25 13:21:28,505 - transform - INFO - Merging conditions into base df...
2025-11-25 13:21:28,565 - transform - INFO - Merging insurance into base df...
2025-11-25 13:21:28,623 - transform - INFO - Merging test_results into base df...
2025-11-25 13:21:28,688 - transform - INFO - Merging admission_types into base df...
2025-11-25 13:21:28,741 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 13:21:30,271 - transform - INFO - Built admissions_df: 39539 rows x 12 columns
2025-11-25 13:21:30,271 - transform - INFO - After reject split: 39539 valid admissions, 17626 rejected rows
2025-11-25 13:21:30,271 - transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (3, 2), 'admissions': (39539, 12), 'rejects': (17626, 16)}
2025-11-25 13:21:30,278 - load - INFO - Starting load()
2025-11-25 13:21:30,278 - load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=3, admission_types=4, admissions=39539, rejects=17626
2025-11-25 13:21:30,278 - load - INFO - Connecting to database...
2025-11-25 13:21:30,447 - load - INFO - Database connection established.
2025-11-25 13:21:30,448 - load - INFO - Creating tables if they do not exist...
2025-11-25 13:21:30,453 - load - INFO - Tables created/verified successfully.
2025-11-25 13:21:30,453 - load - INFO - Truncating tables and resetting identities...
2025-11-25 13:21:30,542 - load - INFO - Tables truncated.
2025-11-25 13:21:30,542 - load - INFO - Inserting into people...
2025-11-25 13:21:37,834 - load - INFO - Inserting into hospitals...
2025-11-25 13:21:43,349 - load - INFO - Inserting into doctors...
2025-11-25 13:21:50,718 - load - INFO - Inserting into conditions...
2025-11-25 13:21:50,720 - load - INFO - Inserting into insurance...
2025-11-25 13:21:50,723 - load - INFO - Inserting into test_results...
2025-11-25 13:21:50,726 - load - INFO - Inserting into admission_types...
2025-11-25 13:21:50,732 - load - INFO - Inserting into admission_data...
2025-11-25 13:22:01,961 - load - INFO - Inserting into rejects...
2025-11-25 13:22:01,991 - load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 283, in load
    cur.execute(
psycopg2.errors.SyntaxError: INSERT has more target columns than expressions
LINE 19:                     missing_columns
                             ^

2025-11-25 13:22:01,993 - load - INFO - Transaction rolled back due to error.
2025-11-25 13:22:01,993 - load - INFO - Database connection closed. End of load().
2025-11-25 13:33:20,868 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 13:33:20,868 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 13:33:21,337 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 13:33:21,339 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 13:33:21,375 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:33:21,399 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:33:22,627 - clean - INFO - Standardized string columns where present.
2025-11-25 13:33:22,710 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:33:22,840 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 13:33:22,876 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:33:22,877 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 13:33:22,877 - clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 13:33:22,878 - clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 13:33:22,882 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 13:33:23,165 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:33:23,188 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:33:23,189 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 13:33:23,190 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 13:33:23,284 - transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 13:33:23,327 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 13:33:23,336 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 13:33:23,393 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 13:33:23,399 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 13:33:23,413 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 13:33:23,424 - transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-11-25 13:33:23,438 - transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-11-25 13:33:23,447 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 13:33:23,449 - transform - INFO - Merging people into base df...
2025-11-25 13:33:23,573 - transform - INFO - Merging doctors into base df...
2025-11-25 13:33:23,629 - transform - INFO - Merging conditions into base df...
2025-11-25 13:33:23,673 - transform - INFO - Merging insurance into base df...
2025-11-25 13:33:24,003 - transform - INFO - Merging test_results into base df...
2025-11-25 13:33:24,147 - transform - INFO - Merging admission_types into base df...
2025-11-25 13:33:24,231 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 13:33:26,040 - transform - INFO - Built admissions_df: 39539 rows x 12 columns
2025-11-25 13:33:26,040 - transform - INFO - After reject split: 39539 valid admissions, 17626 rejected rows
2025-11-25 13:33:26,040 - transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (3, 2), 'admissions': (39539, 12), 'rejects': (17626, 16)}
2025-11-25 13:33:26,051 - load - INFO - Starting load()
2025-11-25 13:33:26,052 - load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=3, admission_types=4, admissions=39539, rejects=17626
2025-11-25 13:33:26,052 - load - INFO - Connecting to database...
2025-11-25 13:33:26,162 - load - INFO - Database connection established.
2025-11-25 13:33:26,162 - load - INFO - Creating tables if they do not exist...
2025-11-25 13:33:26,183 - load - INFO - Tables created/verified successfully.
2025-11-25 13:33:26,183 - load - INFO - Truncating tables and resetting identities...
2025-11-25 13:33:26,309 - load - INFO - Tables truncated.
2025-11-25 13:33:26,309 - load - INFO - Inserting into people...
2025-11-25 13:33:35,074 - load - INFO - Inserting into hospitals...
2025-11-25 13:33:41,422 - load - INFO - Inserting into doctors...
2025-11-25 13:33:49,422 - load - INFO - Inserting into conditions...
2025-11-25 13:33:49,426 - load - INFO - Inserting into insurance...
2025-11-25 13:33:49,431 - load - INFO - Inserting into test_results...
2025-11-25 13:33:49,436 - load - INFO - Inserting into admission_types...
2025-11-25 13:33:49,458 - load - INFO - Inserting into admission_data...
2025-11-25 13:34:01,552 - load - INFO - Inserting into rejects...
2025-11-25 13:34:07,773 - load - INFO - Load completed successfully.
2025-11-25 13:34:07,774 - load - INFO - Database connection closed. End of load().
2025-11-25 13:34:57,288 - read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 13:34:57,288 - read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 13:34:57,564 - read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 13:34:57,564 - clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 13:34:57,587 - clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:34:57,605 - clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 13:34:57,994 - clean - INFO - Standardized string columns where present.
2025-11-25 13:34:58,023 - clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:34:58,116 - clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 13:34:58,161 - clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 13:34:58,162 - clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 13:34:58,166 - clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 13:34:58,167 - clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 13:34:58,169 - clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 13:34:58,203 - clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:34:58,226 - clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 13:34:58,226 - clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 13:34:58,226 - transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 13:34:58,276 - transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 13:34:58,307 - transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 13:34:58,313 - transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 13:34:58,344 - transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 13:34:58,365 - transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 13:34:58,370 - transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 13:34:58,390 - transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-11-25 13:34:58,412 - transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-11-25 13:34:58,418 - transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 13:34:58,418 - transform - INFO - Merging people into base df...
2025-11-25 13:34:58,566 - transform - INFO - Merging doctors into base df...
2025-11-25 13:34:58,620 - transform - INFO - Merging conditions into base df...
2025-11-25 13:34:58,659 - transform - INFO - Merging insurance into base df...
2025-11-25 13:34:58,704 - transform - INFO - Merging test_results into base df...
2025-11-25 13:34:58,764 - transform - INFO - Merging admission_types into base df...
2025-11-25 13:34:58,824 - transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 13:35:00,890 - transform - INFO - Built admissions_df: 39539 rows x 12 columns
2025-11-25 13:35:00,890 - transform - INFO - After reject split: 39539 valid admissions, 17626 rejected rows
2025-11-25 13:35:00,890 - transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (3, 2), 'admissions': (39539, 12), 'rejects': (17626, 16)}
2025-11-25 13:35:00,896 - load - INFO - Starting load()
2025-11-25 13:35:00,896 - load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=3, admission_types=4, admissions=39539, rejects=17626
2025-11-25 13:35:00,896 - load - INFO - Connecting to database...
2025-11-25 13:35:00,950 - load - INFO - Database connection established.
2025-11-25 13:35:00,950 - load - INFO - Creating tables if they do not exist...
2025-11-25 13:35:00,959 - load - INFO - Tables created/verified successfully.
2025-11-25 13:35:00,960 - load - INFO - Truncating tables and resetting identities...
2025-11-25 13:35:01,021 - load - INFO - Tables truncated.
2025-11-25 13:35:01,022 - load - INFO - Inserting into people...
2025-11-25 13:35:09,290 - load - INFO - Inserting into hospitals...
2025-11-25 13:35:13,882 - load - INFO - Inserting into doctors...
2025-11-25 13:35:21,024 - load - INFO - Inserting into conditions...
2025-11-25 13:35:21,026 - load - INFO - Inserting into insurance...
2025-11-25 13:35:21,029 - load - INFO - Inserting into test_results...
2025-11-25 13:35:21,034 - load - INFO - Inserting into admission_types...
2025-11-25 13:35:21,038 - load - INFO - Inserting into admission_data...
2025-11-25 13:35:31,904 - load - INFO - Inserting into rejects...
2025-11-25 13:35:35,869 - load - INFO - Load completed successfully.
2025-11-25 13:35:35,870 - load - INFO - Database connection closed. End of load().
2025-11-25 14:37:01,858 - src.read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 14:37:01,859 - src.read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 14:37:02,258 - src.read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 14:37:02,259 - src.clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 14:37:02,283 - src.clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 14:37:02,294 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 14:37:02,741 - src.clean - INFO - Standardized string columns where present.
2025-11-25 14:37:02,780 - src.clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 14:37:02,980 - src.clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 14:37:03,022 - src.clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 14:37:03,026 - src.clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 14:37:03,029 - src.clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 14:37:03,030 - src.clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 14:37:03,034 - src.clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 14:37:03,091 - src.clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 14:37:03,138 - src.clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 14:37:03,138 - src.clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 14:37:03,139 - src.transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 14:37:03,196 - src.transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 14:37:03,220 - src.transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 14:37:03,239 - src.transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 14:37:03,379 - src.transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 14:37:03,387 - src.transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 14:37:03,397 - src.transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 14:37:03,413 - src.transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-11-25 14:37:03,418 - src.transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-11-25 14:37:03,429 - src.transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 14:37:03,429 - src.transform - INFO - Merging people into base df...
2025-11-25 14:37:03,518 - src.transform - INFO - Merging doctors into base df...
2025-11-25 14:37:03,585 - src.transform - INFO - Merging conditions into base df...
2025-11-25 14:37:03,736 - src.transform - INFO - Merging insurance into base df...
2025-11-25 14:37:03,798 - src.transform - INFO - Merging test_results into base df...
2025-11-25 14:37:03,861 - src.transform - INFO - Merging admission_types into base df...
2025-11-25 14:37:03,928 - src.transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 14:37:05,319 - src.transform - INFO - Built admissions_df: 39539 rows x 12 columns
2025-11-25 14:37:05,320 - src.transform - INFO - After reject split: 39539 valid admissions, 17626 rejected rows
2025-11-25 14:37:05,321 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (3, 2), 'admissions': (39539, 12), 'rejects': (17626, 16)}
2025-11-25 14:37:05,415 - src.load - INFO - Starting load()
2025-11-25 14:37:05,416 - src.load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=3, admission_types=4, admissions=39539, rejects=17626
2025-11-25 14:37:05,417 - src.load - INFO - Connecting to database...
2025-11-25 14:37:05,444 - src.load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 37, in load
    conn = psycopg2.connect(db_url)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/psycopg2/__init__.py", line 121, in connect
    dsn = _ext.make_dsn(dsn, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/psycopg2/extensions.py", line 145, in make_dsn
    parse_dsn(dsn)
psycopg2.ProgrammingError: invalid dsn: missing "=" after "${DB_URL}" in connection info string

2025-11-25 14:37:05,461 - src.load - INFO - Database connection closed. End of load().
2025-11-25 14:38:06,419 - src.read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-11-25 14:38:06,419 - src.read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-11-25 14:38:06,960 - src.read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-11-25 14:38:06,960 - src.clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-11-25 14:38:06,980 - src.clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 14:38:06,988 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 14:38:07,565 - src.clean - INFO - Standardized string columns where present.
2025-11-25 14:38:07,598 - src.clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-11-25 14:38:07,785 - src.clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 14:38:07,855 - src.clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-11-25 14:38:07,856 - src.clean - INFO - Age range before validation: min=0.0, max=150.0
2025-11-25 14:38:07,858 - src.clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-11-25 14:38:07,860 - src.clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-11-25 14:38:07,862 - src.clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 14:38:07,943 - src.clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 14:38:07,962 - src.clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-11-25 14:38:07,962 - src.clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-11-25 14:38:07,963 - src.transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-11-25 14:38:08,038 - src.transform - INFO - Built people_df: 55143 rows x 5 columns
2025-11-25 14:38:08,079 - src.transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-11-25 14:38:08,093 - src.transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-11-25 14:38:08,148 - src.transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-11-25 14:38:08,155 - src.transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-11-25 14:38:08,164 - src.transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-11-25 14:38:08,178 - src.transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-11-25 14:38:08,183 - src.transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-11-25 14:38:08,197 - src.transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-11-25 14:38:08,197 - src.transform - INFO - Merging people into base df...
2025-11-25 14:38:08,301 - src.transform - INFO - Merging doctors into base df...
2025-11-25 14:38:08,389 - src.transform - INFO - Merging conditions into base df...
2025-11-25 14:38:08,636 - src.transform - INFO - Merging insurance into base df...
2025-11-25 14:38:08,702 - src.transform - INFO - Merging test_results into base df...
2025-11-25 14:38:08,848 - src.transform - INFO - Merging admission_types into base df...
2025-11-25 14:38:08,934 - src.transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-11-25 14:38:10,643 - src.transform - INFO - Built admissions_df: 39539 rows x 12 columns
2025-11-25 14:38:10,643 - src.transform - INFO - After reject split: 39539 valid admissions, 17626 rejected rows
2025-11-25 14:38:10,644 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (3, 2), 'admissions': (39539, 12), 'rejects': (17626, 16)}
2025-11-25 14:38:10,651 - src.load - INFO - Starting load()
2025-11-25 14:38:10,652 - src.load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=3, admission_types=4, admissions=39539, rejects=17626
2025-11-25 14:38:10,652 - src.load - INFO - Connecting to database...
2025-11-25 14:38:10,886 - src.load - INFO - Database connection established.
2025-11-25 14:38:10,886 - src.load - INFO - Creating tables if they do not exist...
2025-11-25 14:38:10,968 - src.load - INFO - Tables created/verified successfully.
2025-11-25 14:38:10,968 - src.load - INFO - Truncating tables and resetting identities...
2025-11-25 14:38:11,241 - src.load - INFO - Tables truncated.
2025-11-25 14:38:11,242 - src.load - INFO - Inserting into people...
2025-11-25 14:38:25,242 - src.load - INFO - Inserting into hospitals...
2025-11-25 14:38:31,459 - src.load - INFO - Inserting into doctors...
2025-11-25 14:38:41,015 - src.load - INFO - Inserting into conditions...
2025-11-25 14:38:41,025 - src.load - INFO - Inserting into insurance...
2025-11-25 14:38:41,061 - src.load - INFO - Inserting into test_results...
2025-11-25 14:38:41,079 - src.load - INFO - Inserting into admission_types...
2025-11-25 14:38:41,087 - src.load - INFO - Inserting into admission_data...
2025-11-25 14:38:54,344 - src.load - INFO - Inserting into rejects...
2025-11-25 14:39:01,258 - src.load - INFO - Load completed successfully.
2025-11-25 14:39:01,259 - src.load - INFO - Database connection closed. End of load().
2025-11-25 15:04:06,128 - src.transform - INFO - Starting transform(): input df has 1 rows x 15 columns
2025-11-25 15:04:06,138 - src.transform - INFO - Built people_df: 1 rows x 5 columns
2025-11-25 15:04:06,139 - src.transform - INFO - Built doctors_df (pre-hospital merge): 1 rows x 3 columns
2025-11-25 15:04:06,141 - src.transform - INFO - Built hospitals_df: 1 rows x 2 columns
2025-11-25 15:04:06,144 - src.transform - INFO - Updated doctors_df after hospital merge: 1 rows x 4 columns
2025-11-25 15:04:06,145 - src.transform - INFO - Built conditions_df: 1 rows x 2 columns
2025-11-25 15:04:06,146 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-11-25 15:04:06,148 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-11-25 15:04:06,149 - src.transform - INFO - Built test_results_df: 0 rows x 2 columns
2025-11-25 15:04:06,150 - src.transform - INFO - Built admission_types_df: 1 rows x 2 columns
2025-11-25 15:04:06,150 - src.transform - INFO - Merging people into base df...
2025-11-25 15:04:06,153 - src.transform - INFO - Merging doctors into base df...
2025-11-25 15:04:06,154 - src.transform - INFO - Merging conditions into base df...
2025-11-25 15:04:06,155 - src.transform - INFO - Merging insurance into base df...
2025-11-25 15:04:06,156 - src.transform - INFO - Merging test_results into base df...
2025-11-25 15:04:06,157 - src.transform - INFO - Merging admission_types into base df...
2025-11-25 15:04:06,158 - src.transform - INFO - Finished merges; df is now 1 rows x 27 columns
2025-11-25 15:04:06,164 - src.transform - INFO - Built admissions_df: 0 rows x 12 columns
2025-11-25 15:04:06,164 - src.transform - INFO - After reject split: 0 valid admissions, 1 rejected rows
2025-11-25 15:04:06,164 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (1, 5), 'doctors': (1, 4), 'hospitals': (1, 2), 'conditions': (1, 2), 'insurance': (1, 2), 'admission_types': (1, 2), 'test_results': (0, 2), 'admissions': (0, 12), 'rejects': (1, 16)}
2025-11-25 15:06:09,552 - src.transform - INFO - Starting transform(): input df has 1 rows x 15 columns
2025-11-25 15:06:09,571 - src.transform - INFO - Built people_df: 1 rows x 5 columns
2025-11-25 15:06:09,572 - src.transform - INFO - Built doctors_df (pre-hospital merge): 1 rows x 3 columns
2025-11-25 15:06:09,573 - src.transform - INFO - Built hospitals_df: 1 rows x 2 columns
2025-11-25 15:06:09,576 - src.transform - INFO - Updated doctors_df after hospital merge: 1 rows x 4 columns
2025-11-25 15:06:09,577 - src.transform - INFO - Built conditions_df: 1 rows x 2 columns
2025-11-25 15:06:09,578 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-11-25 15:06:09,581 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-11-25 15:06:09,581 - src.transform - INFO - Built test_results_df: 0 rows x 2 columns
2025-11-25 15:06:09,583 - src.transform - INFO - Built admission_types_df: 1 rows x 2 columns
2025-11-25 15:06:09,583 - src.transform - INFO - Merging people into base df...
2025-11-25 15:06:09,615 - src.transform - INFO - Merging doctors into base df...
2025-11-25 15:06:09,620 - src.transform - INFO - Merging conditions into base df...
2025-11-25 15:06:09,624 - src.transform - INFO - Merging insurance into base df...
2025-11-25 15:06:09,627 - src.transform - INFO - Merging test_results into base df...
2025-11-25 15:06:09,629 - src.transform - INFO - Merging admission_types into base df...
2025-11-25 15:06:09,630 - src.transform - INFO - Finished merges; df is now 1 rows x 27 columns
2025-11-25 15:06:09,638 - src.transform - INFO - Built admissions_df: 0 rows x 12 columns
2025-11-25 15:06:09,638 - src.transform - INFO - After reject split: 0 valid admissions, 1 rejected rows
2025-11-25 15:06:09,638 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (1, 5), 'doctors': (1, 4), 'hospitals': (1, 2), 'conditions': (1, 2), 'insurance': (1, 2), 'admission_types': (1, 2), 'test_results': (0, 2), 'admissions': (0, 12), 'rejects': (1, 16)}
2025-11-25 15:08:20,056 - src.transform - INFO - Starting transform(): input df has 1 rows x 15 columns
2025-11-25 15:08:20,077 - src.transform - INFO - Built people_df: 1 rows x 5 columns
2025-11-25 15:08:20,080 - src.transform - INFO - Built doctors_df (pre-hospital merge): 1 rows x 3 columns
2025-11-25 15:08:20,084 - src.transform - INFO - Built hospitals_df: 1 rows x 2 columns
2025-11-25 15:08:20,092 - src.transform - INFO - Updated doctors_df after hospital merge: 1 rows x 4 columns
2025-11-25 15:08:20,094 - src.transform - INFO - Built conditions_df: 1 rows x 2 columns
2025-11-25 15:08:20,098 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-11-25 15:08:20,107 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-11-25 15:08:20,108 - src.transform - INFO - Built test_results_df: 0 rows x 2 columns
2025-11-25 15:08:20,109 - src.transform - INFO - Built admission_types_df: 1 rows x 2 columns
2025-11-25 15:08:20,110 - src.transform - INFO - Merging people into base df...
2025-11-25 15:08:20,113 - src.transform - INFO - Merging doctors into base df...
2025-11-25 15:08:20,116 - src.transform - INFO - Merging conditions into base df...
2025-11-25 15:08:20,117 - src.transform - INFO - Merging insurance into base df...
2025-11-25 15:08:20,118 - src.transform - INFO - Merging test_results into base df...
2025-11-25 15:08:20,120 - src.transform - INFO - Merging admission_types into base df...
2025-11-25 15:08:20,122 - src.transform - INFO - Finished merges; df is now 1 rows x 27 columns
2025-11-25 15:08:20,128 - src.transform - INFO - Built admissions_df: 0 rows x 12 columns
2025-11-25 15:08:20,129 - src.transform - INFO - After reject split: 0 valid admissions, 1 rejected rows
2025-11-25 15:08:20,129 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (1, 5), 'doctors': (1, 4), 'hospitals': (1, 2), 'conditions': (1, 2), 'insurance': (1, 2), 'admission_types': (1, 2), 'test_results': (0, 2), 'admissions': (0, 12), 'rejects': (1, 16)}
2025-11-25 15:14:14,134 - src.clean - INFO - Starting clean(): input df has 1 rows x 9 columns
2025-11-25 15:14:14,135 - src.clean - INFO - Normalized column names. Before: ['name', 'age', 'gender', 'blood_type', 'doctor', 'hospital', 'insurance_provider', 'medical_condition', 'test_results'] | After: ['name', 'age', 'gender', 'blood_type', 'doctor', 'hospital', 'insurance_provider', 'medical_condition', 'test_results']
2025-11-25 15:14:14,136 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'blood_type', 'doctor', 'hospital', 'insurance_provider', 'medical_condition', 'test_results']
2025-11-25 15:14:14,158 - src.clean - WARNING - test_results: 1 value(s) not in ['inconclusive', 'normal', 'abnormal']; setting to NA
2025-11-25 15:14:14,158 - src.clean - INFO - Standardized string columns where present.
2025-11-25 15:14:14,161 - src.clean - INFO - Column age converted to numeric successfully.
2025-11-25 15:14:14,161 - src.clean - INFO - Age range before validation: min=30, max=30
2025-11-25 15:14:14,162 - src.clean - INFO - clean() completed. Output df has 1 rows x 9 columns
2025-11-25 15:14:14,165 - src.transform - INFO - Starting transform(): input df has 1 rows x 15 columns
2025-11-25 15:14:14,168 - src.transform - INFO - Built people_df: 1 rows x 5 columns
2025-11-25 15:14:14,169 - src.transform - INFO - Built doctors_df (pre-hospital merge): 1 rows x 3 columns
2025-11-25 15:14:14,170 - src.transform - INFO - Built hospitals_df: 1 rows x 2 columns
2025-11-25 15:14:14,176 - src.transform - INFO - Updated doctors_df after hospital merge: 1 rows x 4 columns
2025-11-25 15:14:14,180 - src.transform - INFO - Built conditions_df: 1 rows x 2 columns
2025-11-25 15:14:14,181 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-11-25 15:14:14,182 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-11-25 15:14:14,183 - src.transform - INFO - Built test_results_df: 0 rows x 2 columns
2025-11-25 15:14:14,184 - src.transform - INFO - Built admission_types_df: 1 rows x 2 columns
2025-11-25 15:14:14,184 - src.transform - INFO - Merging people into base df...
2025-11-25 15:14:14,192 - src.transform - INFO - Merging doctors into base df...
2025-11-25 15:14:14,196 - src.transform - INFO - Merging conditions into base df...
2025-11-25 15:14:14,198 - src.transform - INFO - Merging insurance into base df...
2025-11-25 15:14:14,200 - src.transform - INFO - Merging test_results into base df...
2025-11-25 15:14:14,209 - src.transform - INFO - Merging admission_types into base df...
2025-11-25 15:14:14,212 - src.transform - INFO - Finished merges; df is now 1 rows x 27 columns
2025-11-25 15:14:14,221 - src.transform - INFO - Built admissions_df: 0 rows x 12 columns
2025-11-25 15:14:14,221 - src.transform - INFO - After reject split: 0 valid admissions, 1 rejected rows
2025-11-25 15:14:14,221 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (1, 5), 'doctors': (1, 4), 'hospitals': (1, 2), 'conditions': (1, 2), 'insurance': (1, 2), 'admission_types': (1, 2), 'test_results': (0, 2), 'admissions': (0, 12), 'rejects': (1, 16)}
2025-11-25 15:14:14,221 - src.clean - INFO - Starting clean(): input df has 1 rows x 15 columns
2025-11-25 15:14:14,222 - src.clean - INFO - Normalized column names. Before: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 15:14:14,223 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-11-25 15:14:14,234 - src.clean - WARNING - test_results: 1 value(s) not in ['inconclusive', 'normal', 'abnormal']; setting to NA
2025-11-25 15:14:14,235 - src.clean - INFO - Standardized string columns where present.
2025-11-25 15:14:14,236 - src.clean - INFO - Column age converted to numeric successfully.
2025-11-25 15:14:14,237 - src.clean - INFO - Column billing_amount converted to numeric successfully.
2025-11-25 15:14:14,237 - src.clean - INFO - Column room_number converted to numeric successfully.
2025-11-25 15:14:14,238 - src.clean - INFO - Age range before validation: min=30, max=30
2025-11-25 15:14:14,238 - src.clean - INFO - Room_number range before validation: min=101, max=101
2025-11-25 15:14:14,239 - src.clean - INFO - Rounded billing_amount to 2 decimal places.
2025-11-25 15:14:14,243 - src.clean - INFO - Column date_of_admission parsed as datetime successfully.
2025-11-25 15:14:14,244 - src.clean - INFO - Column discharge_date parsed as datetime successfully.
2025-11-25 15:14:14,244 - src.clean - INFO - clean() completed. Output df has 1 rows x 15 columns
2025-11-26 09:34:19,276 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-11-26 09:34:19,277 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospital Name'] | After: ['name', 'gender', 'hospital_name']
2025-11-26 09:34:19,301 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital_name']
2025-11-26 09:34:19,360 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:34:19,360 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-11-26 09:34:19,494 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-11-26 09:34:19,494 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-11-26 09:34:19,495 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-11-26 09:34:19,500 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:34:19,500 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-11-26 09:39:34,603 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-11-26 09:39:34,604 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-11-26 09:39:34,626 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-11-26 09:39:34,690 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:39:34,690 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-11-26 09:39:34,981 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-11-26 09:39:34,984 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-11-26 09:39:34,986 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-11-26 09:39:35,001 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:39:35,002 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-11-26 09:39:46,935 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-11-26 09:39:46,936 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-11-26 09:39:46,946 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-11-26 09:39:47,011 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:39:47,011 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-11-26 09:39:47,149 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-11-26 09:39:47,149 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-11-26 09:39:47,151 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-11-26 09:39:47,157 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:39:47,158 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-11-26 09:39:57,259 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-11-26 09:39:57,260 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-11-26 09:39:57,261 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-11-26 09:39:57,277 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:39:57,278 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-11-26 09:39:57,470 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-11-26 09:39:57,472 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-11-26 09:39:57,472 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-11-26 09:39:57,475 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:39:57,475 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-11-26 09:40:04,945 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-11-26 09:40:04,949 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-11-26 09:40:04,950 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-11-26 09:40:04,970 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:40:04,970 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-11-26 09:40:04,982 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-11-26 09:40:04,983 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-11-26 09:40:04,984 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-11-26 09:40:04,992 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:40:04,998 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-11-26 09:48:56,977 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-11-26 09:48:56,981 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-11-26 09:48:57,000 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-11-26 09:48:57,073 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:48:57,073 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-11-26 09:48:57,080 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-11-26 09:48:57,082 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-11-26 09:48:57,082 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-11-26 09:48:57,091 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:48:57,091 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-11-26 09:48:57,189 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-11-26 09:48:57,210 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-11-26 09:48:57,211 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-11-26 09:48:57,216 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-11-26 09:48:57,221 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-11-26 09:48:57,222 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-11-26 09:48:57,223 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-11-26 09:48:57,227 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-11-26 09:48:57,228 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-11-26 09:48:57,228 - src.transform - INFO - Merging people into base df...
2025-11-26 09:48:57,232 - src.transform - INFO - Merging doctors into base df...
2025-11-26 09:48:57,233 - src.transform - INFO - Merging conditions into base df...
2025-11-26 09:48:57,234 - src.transform - INFO - Merging insurance into base df...
2025-11-26 09:48:57,237 - src.transform - INFO - Merging test_results into base df...
2025-11-26 09:48:57,239 - src.transform - INFO - Merging admission_types into base df...
2025-11-26 09:48:57,240 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-11-26 09:48:57,251 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-11-26 09:48:57,251 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-11-26 09:48:57,251 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-11-26 09:48:57,255 - src.transform - INFO - Starting transform(): input df has 3 rows x 15 columns
2025-11-26 09:48:57,257 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-11-26 09:48:57,258 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-11-26 09:48:57,259 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-11-26 09:48:57,261 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-11-26 09:48:57,262 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-11-26 09:48:57,263 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-11-26 09:48:57,273 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-11-26 09:48:57,287 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-11-26 09:48:57,290 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-11-26 09:48:57,290 - src.transform - INFO - Merging people into base df...
2025-11-26 09:48:57,293 - src.transform - INFO - Merging doctors into base df...
2025-11-26 09:48:57,294 - src.transform - INFO - Merging conditions into base df...
2025-11-26 09:48:57,302 - src.transform - INFO - Merging insurance into base df...
2025-11-26 09:48:57,304 - src.transform - INFO - Merging test_results into base df...
2025-11-26 09:48:57,305 - src.transform - INFO - Merging admission_types into base df...
2025-11-26 09:48:57,312 - src.transform - INFO - Finished merges; df is now 3 rows x 27 columns
2025-11-26 09:48:57,318 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-11-26 09:48:57,318 - src.transform - INFO - After reject split: 2 valid admissions, 1 rejected rows
2025-11-26 09:48:57,318 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (1, 16)}
2025-11-26 09:48:57,446 - src.transform - INFO - Starting transform(): input df has 1 rows x 14 columns
2025-11-26 09:48:57,446 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-11-26 09:50:16,378 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-11-26 09:50:16,380 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-11-26 09:50:16,384 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-11-26 09:50:16,401 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:50:16,401 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-11-26 09:50:16,403 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-11-26 09:50:16,403 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-11-26 09:50:16,403 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-11-26 09:50:16,407 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:50:16,407 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-11-26 09:50:16,411 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-11-26 09:50:16,416 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-11-26 09:50:16,417 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-11-26 09:50:16,419 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-11-26 09:50:16,423 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-11-26 09:50:16,424 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-11-26 09:50:16,426 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-11-26 09:50:16,432 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-11-26 09:50:16,434 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-11-26 09:50:16,434 - src.transform - INFO - Merging people into base df...
2025-11-26 09:50:16,436 - src.transform - INFO - Merging doctors into base df...
2025-11-26 09:50:16,439 - src.transform - INFO - Merging conditions into base df...
2025-11-26 09:50:16,440 - src.transform - INFO - Merging insurance into base df...
2025-11-26 09:50:16,444 - src.transform - INFO - Merging test_results into base df...
2025-11-26 09:50:16,445 - src.transform - INFO - Merging admission_types into base df...
2025-11-26 09:50:16,446 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-11-26 09:50:16,453 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-11-26 09:50:16,453 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-11-26 09:50:16,453 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-11-26 09:50:16,459 - src.transform - INFO - Starting transform(): input df has 3 rows x 15 columns
2025-11-26 09:50:16,461 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-11-26 09:50:16,462 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-11-26 09:50:16,463 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-11-26 09:50:16,465 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-11-26 09:50:16,467 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-11-26 09:50:16,469 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-11-26 09:50:16,470 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-11-26 09:50:16,471 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-11-26 09:50:16,473 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-11-26 09:50:16,473 - src.transform - INFO - Merging people into base df...
2025-11-26 09:50:16,508 - src.transform - INFO - Merging doctors into base df...
2025-11-26 09:50:16,509 - src.transform - INFO - Merging conditions into base df...
2025-11-26 09:50:16,511 - src.transform - INFO - Merging insurance into base df...
2025-11-26 09:50:16,512 - src.transform - INFO - Merging test_results into base df...
2025-11-26 09:50:16,514 - src.transform - INFO - Merging admission_types into base df...
2025-11-26 09:50:16,515 - src.transform - INFO - Finished merges; df is now 3 rows x 27 columns
2025-11-26 09:50:16,521 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-11-26 09:50:16,521 - src.transform - INFO - After reject split: 2 valid admissions, 1 rejected rows
2025-11-26 09:50:16,521 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (1, 16)}
2025-11-26 09:50:16,641 - src.transform - INFO - Starting transform(): input df has 1 rows x 14 columns
2025-11-26 09:50:16,642 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-11-26 09:52:58,429 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-11-26 09:52:58,429 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-11-26 09:52:58,432 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-11-26 09:52:58,453 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:52:58,454 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-11-26 09:52:58,456 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-11-26 09:52:58,457 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-11-26 09:52:58,457 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-11-26 09:52:58,463 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:52:58,463 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-11-26 09:52:58,468 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-11-26 09:52:58,474 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-11-26 09:52:58,477 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-11-26 09:52:58,480 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-11-26 09:52:58,489 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-11-26 09:52:58,490 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-11-26 09:52:58,492 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-11-26 09:52:58,495 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-11-26 09:52:58,496 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-11-26 09:52:58,497 - src.transform - INFO - Merging people into base df...
2025-11-26 09:52:58,501 - src.transform - INFO - Merging doctors into base df...
2025-11-26 09:52:58,503 - src.transform - INFO - Merging conditions into base df...
2025-11-26 09:52:58,505 - src.transform - INFO - Merging insurance into base df...
2025-11-26 09:52:58,509 - src.transform - INFO - Merging test_results into base df...
2025-11-26 09:52:58,510 - src.transform - INFO - Merging admission_types into base df...
2025-11-26 09:52:58,513 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-11-26 09:52:58,523 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-11-26 09:52:58,523 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-11-26 09:52:58,524 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-11-26 09:52:58,539 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-11-26 09:52:58,820 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-11-26 09:56:09,853 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-11-26 09:56:09,854 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-11-26 09:56:09,893 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-11-26 09:56:09,967 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:56:09,967 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-11-26 09:56:09,970 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-11-26 09:56:09,970 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-11-26 09:56:09,971 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-11-26 09:56:09,975 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:56:09,975 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-11-26 09:56:09,998 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-11-26 09:56:10,080 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-11-26 09:56:10,081 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-11-26 09:56:10,083 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-11-26 09:56:10,091 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-11-26 09:56:10,092 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-11-26 09:56:10,094 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-11-26 09:56:10,096 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-11-26 09:56:10,097 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-11-26 09:56:10,097 - src.transform - INFO - Merging people into base df...
2025-11-26 09:56:10,099 - src.transform - INFO - Merging doctors into base df...
2025-11-26 09:56:10,101 - src.transform - INFO - Merging conditions into base df...
2025-11-26 09:56:10,102 - src.transform - INFO - Merging insurance into base df...
2025-11-26 09:56:10,104 - src.transform - INFO - Merging test_results into base df...
2025-11-26 09:56:10,106 - src.transform - INFO - Merging admission_types into base df...
2025-11-26 09:56:10,107 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-11-26 09:56:10,113 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-11-26 09:56:10,113 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-11-26 09:56:10,113 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-11-26 09:56:10,127 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-11-26 09:56:10,293 - src.transform - INFO - Starting transform(): input df has 1 rows x 14 columns
2025-11-26 09:56:10,293 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-11-26 09:57:42,794 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-11-26 09:57:42,795 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-11-26 09:57:42,809 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-11-26 09:57:42,834 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:57:42,834 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-11-26 09:57:42,849 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-11-26 09:57:42,850 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-11-26 09:57:42,851 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-11-26 09:57:42,859 - src.clean - INFO - Standardized string columns where present.
2025-11-26 09:57:42,859 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-11-26 09:57:42,911 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-11-26 09:57:42,923 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-11-26 09:57:42,927 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-11-26 09:57:42,956 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-11-26 09:57:42,985 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-11-26 09:57:42,988 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-11-26 09:57:42,990 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-11-26 09:57:42,992 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-11-26 09:57:42,994 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-11-26 09:57:42,994 - src.transform - INFO - Merging people into base df...
2025-11-26 09:57:42,997 - src.transform - INFO - Merging doctors into base df...
2025-11-26 09:57:43,000 - src.transform - INFO - Merging conditions into base df...
2025-11-26 09:57:43,002 - src.transform - INFO - Merging insurance into base df...
2025-11-26 09:57:43,009 - src.transform - INFO - Merging test_results into base df...
2025-11-26 09:57:43,010 - src.transform - INFO - Merging admission_types into base df...
2025-11-26 09:57:43,013 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-11-26 09:57:43,057 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-11-26 09:57:43,057 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-11-26 09:57:43,057 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-11-26 09:57:43,064 - src.transform - INFO - Starting transform(): input df has 3 rows x 15 columns
2025-11-26 09:57:43,065 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-11-26 09:57:43,106 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-11-26 09:57:43,107 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-11-26 09:57:43,141 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-11-26 09:57:43,142 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-11-26 09:57:43,143 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-11-26 09:57:43,146 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-11-26 09:57:43,147 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-11-26 09:57:43,170 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-11-26 09:57:43,170 - src.transform - INFO - Merging people into base df...
2025-11-26 09:57:43,172 - src.transform - INFO - Merging doctors into base df...
2025-11-26 09:57:43,174 - src.transform - INFO - Merging conditions into base df...
2025-11-26 09:57:43,175 - src.transform - INFO - Merging insurance into base df...
2025-11-26 09:57:43,176 - src.transform - INFO - Merging test_results into base df...
2025-11-26 09:57:43,177 - src.transform - INFO - Merging admission_types into base df...
2025-11-26 09:57:43,178 - src.transform - INFO - Finished merges; df is now 3 rows x 27 columns
2025-11-26 09:57:43,183 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-11-26 09:57:43,183 - src.transform - INFO - After reject split: 2 valid admissions, 1 rejected rows
2025-11-26 09:57:43,183 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (1, 16)}
2025-11-26 09:57:43,187 - src.transform - INFO - Starting transform(): input df has 1 rows x 14 columns
2025-11-26 09:57:43,189 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-12-01 08:35:04,225 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-12-01 08:35:04,226 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-12-01 08:35:04,263 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-12-01 08:35:04,300 - src.clean - INFO - Standardized string columns where present.
2025-12-01 08:35:04,300 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-12-01 08:35:04,302 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-12-01 08:35:04,302 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-12-01 08:35:04,303 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-12-01 08:35:04,306 - src.clean - INFO - Standardized string columns where present.
2025-12-01 08:35:04,306 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-12-01 08:35:04,318 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-12-01 08:35:04,351 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-12-01 08:35:04,352 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-12-01 08:35:04,354 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-12-01 08:35:04,375 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 08:35:04,377 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-12-01 08:35:04,379 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-12-01 08:35:04,387 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-12-01 08:35:04,388 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-12-01 08:35:04,388 - src.transform - INFO - Merging people into base df...
2025-12-01 08:35:04,390 - src.transform - INFO - Merging doctors into base df...
2025-12-01 08:35:04,392 - src.transform - INFO - Merging conditions into base df...
2025-12-01 08:35:04,393 - src.transform - INFO - Merging insurance into base df...
2025-12-01 08:35:04,397 - src.transform - INFO - Merging test_results into base df...
2025-12-01 08:35:04,398 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 08:35:04,399 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-12-01 08:35:04,409 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 08:35:04,409 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-12-01 08:35:04,409 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-12-01 08:35:04,413 - src.transform - INFO - Starting transform(): input df has 3 rows x 15 columns
2025-12-01 08:35:04,415 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-12-01 08:35:04,416 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-12-01 08:35:04,417 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-12-01 08:35:04,419 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 08:35:04,420 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-12-01 08:35:04,422 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-12-01 08:35:04,422 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-12-01 08:35:04,423 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-12-01 08:35:04,424 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-12-01 08:35:04,424 - src.transform - INFO - Merging people into base df...
2025-12-01 08:35:04,426 - src.transform - INFO - Merging doctors into base df...
2025-12-01 08:35:04,427 - src.transform - INFO - Merging conditions into base df...
2025-12-01 08:35:04,429 - src.transform - INFO - Merging insurance into base df...
2025-12-01 08:35:04,430 - src.transform - INFO - Merging test_results into base df...
2025-12-01 08:35:04,431 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 08:35:04,432 - src.transform - INFO - Finished merges; df is now 3 rows x 27 columns
2025-12-01 08:35:04,437 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 08:35:04,437 - src.transform - INFO - After reject split: 2 valid admissions, 1 rejected rows
2025-12-01 08:35:04,437 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (1, 16)}
2025-12-01 08:35:04,440 - src.transform - INFO - Starting transform(): input df has 1 rows x 14 columns
2025-12-01 08:35:04,441 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-12-01 08:55:45,978 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-12-01 08:55:45,979 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-12-01 08:55:45,988 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-12-01 08:55:46,006 - src.clean - INFO - Standardized string columns where present.
2025-12-01 08:55:46,007 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-12-01 08:55:46,009 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-12-01 08:55:46,009 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-12-01 08:55:46,010 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-12-01 08:55:46,013 - src.clean - INFO - Standardized string columns where present.
2025-12-01 08:55:46,013 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-12-01 08:55:46,076 - src.load - INFO - Starting load()
2025-12-01 08:55:46,076 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 08:55:46,076 - src.load - INFO - Connecting to database...
2025-12-01 08:55:46,076 - src.load - INFO - Database connection established.
2025-12-01 08:55:46,076 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 08:55:46,076 - src.load - INFO - Tables created/verified successfully.
2025-12-01 08:55:46,076 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 08:55:46,076 - src.load - INFO - Tables truncated.
2025-12-01 08:55:46,076 - src.load - INFO - Inserting into people...
2025-12-01 08:55:46,077 - src.load - INFO - Inserting into hospitals...
2025-12-01 08:55:46,077 - src.load - INFO - Inserting into doctors...
2025-12-01 08:55:46,077 - src.load - INFO - Inserting into conditions...
2025-12-01 08:55:46,078 - src.load - INFO - Inserting into insurance...
2025-12-01 08:55:46,078 - src.load - INFO - Inserting into test_results...
2025-12-01 08:55:46,078 - src.load - INFO - Inserting into admission_types...
2025-12-01 08:55:46,079 - src.load - INFO - Inserting into admission_data...
2025-12-01 08:55:46,086 - src.load - INFO - Inserting into rejects...
2025-12-01 08:55:46,087 - src.load - INFO - Load completed successfully.
2025-12-01 08:55:46,087 - src.load - INFO - Database connection closed. End of load().
2025-12-01 08:55:46,091 - src.load - INFO - Starting load()
2025-12-01 08:55:46,091 - src.load - INFO - Row counts - people=3, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 08:55:46,091 - src.load - INFO - Connecting to database...
2025-12-01 08:55:46,091 - src.load - INFO - Database connection established.
2025-12-01 08:55:46,091 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 08:55:46,091 - src.load - INFO - Tables created/verified successfully.
2025-12-01 08:55:46,091 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 08:55:46,091 - src.load - INFO - Tables truncated.
2025-12-01 08:55:46,091 - src.load - INFO - Inserting into people...
2025-12-01 08:55:46,093 - src.load - WARNING - Invalid age 150 for person Too Old; setting age to NULL before insert
2025-12-01 08:55:46,093 - src.load - INFO - Inserting into hospitals...
2025-12-01 08:55:46,093 - src.load - INFO - Inserting into doctors...
2025-12-01 08:55:46,093 - src.load - INFO - Inserting into conditions...
2025-12-01 08:55:46,094 - src.load - INFO - Inserting into insurance...
2025-12-01 08:55:46,094 - src.load - INFO - Inserting into test_results...
2025-12-01 08:55:46,094 - src.load - INFO - Inserting into admission_types...
2025-12-01 08:55:46,094 - src.load - INFO - Inserting into admission_data...
2025-12-01 08:55:46,095 - src.load - INFO - Inserting into rejects...
2025-12-01 08:55:46,096 - src.load - INFO - Load completed successfully.
2025-12-01 08:55:46,096 - src.load - INFO - Database connection closed. End of load().
2025-12-01 08:55:46,143 - src.load - INFO - Starting load()
2025-12-01 08:55:46,144 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 08:55:46,144 - src.load - INFO - Connecting to database...
2025-12-01 08:55:46,144 - src.load - INFO - Database connection established.
2025-12-01 08:55:46,144 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 08:55:46,144 - src.load - INFO - Tables created/verified successfully.
2025-12-01 08:55:46,144 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 08:55:46,144 - src.load - INFO - Tables truncated.
2025-12-01 08:55:46,144 - src.load - INFO - Inserting into people...
2025-12-01 08:55:46,145 - src.load - ERROR - Failed inserting people row: Pandas(person_id=1, name='Error Person', age=40, gender='M', blood_type='AB+')
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 19, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-01 08:55:46,185 - src.load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 19, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-01 08:55:46,185 - src.load - INFO - Transaction rolled back due to error.
2025-12-01 08:55:46,186 - src.load - INFO - Database connection closed. End of load().
2025-12-01 08:55:46,196 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-12-01 08:55:46,202 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-12-01 08:55:46,204 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-12-01 08:55:46,208 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-12-01 08:55:46,213 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 08:55:46,215 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-12-01 08:55:46,217 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-12-01 08:55:46,219 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-12-01 08:55:46,221 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-12-01 08:55:46,221 - src.transform - INFO - Merging people into base df...
2025-12-01 08:55:46,233 - src.transform - INFO - Merging doctors into base df...
2025-12-01 08:55:46,235 - src.transform - INFO - Merging conditions into base df...
2025-12-01 08:55:46,236 - src.transform - INFO - Merging insurance into base df...
2025-12-01 08:55:46,239 - src.transform - INFO - Merging test_results into base df...
2025-12-01 08:55:46,240 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 08:55:46,242 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-12-01 08:55:46,249 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 08:55:46,249 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-12-01 08:55:46,249 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-12-01 08:55:46,254 - src.transform - INFO - Starting transform(): input df has 3 rows x 15 columns
2025-12-01 08:55:46,256 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-12-01 08:55:46,258 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-12-01 08:55:46,259 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-12-01 08:55:46,262 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 08:55:46,263 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-12-01 08:55:46,265 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-12-01 08:55:46,266 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-12-01 08:55:46,267 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-12-01 08:55:46,268 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-12-01 08:55:46,268 - src.transform - INFO - Merging people into base df...
2025-12-01 08:55:46,269 - src.transform - INFO - Merging doctors into base df...
2025-12-01 08:55:46,271 - src.transform - INFO - Merging conditions into base df...
2025-12-01 08:55:46,273 - src.transform - INFO - Merging insurance into base df...
2025-12-01 08:55:46,274 - src.transform - INFO - Merging test_results into base df...
2025-12-01 08:55:46,278 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 08:55:46,280 - src.transform - INFO - Finished merges; df is now 3 rows x 27 columns
2025-12-01 08:55:46,288 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 08:55:46,290 - src.transform - INFO - After reject split: 2 valid admissions, 1 rejected rows
2025-12-01 08:55:46,290 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (1, 16)}
2025-12-01 08:55:46,297 - src.transform - INFO - Starting transform(): input df has 1 rows x 14 columns
2025-12-01 08:55:46,297 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-12-01 10:35:22,789 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-12-01 10:35:22,791 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-12-01 10:35:22,793 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-12-01 10:35:22,813 - src.clean - INFO - Standardized string columns where present.
2025-12-01 10:35:22,813 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-12-01 10:35:22,820 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-12-01 10:35:22,821 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-12-01 10:35:22,821 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-12-01 10:35:22,825 - src.clean - INFO - Standardized string columns where present.
2025-12-01 10:35:22,826 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-12-01 10:35:22,841 - src.load - INFO - Starting load()
2025-12-01 10:35:22,842 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 10:35:22,842 - src.load - INFO - Connecting to database...
2025-12-01 10:35:22,842 - src.load - INFO - Database connection established.
2025-12-01 10:35:22,842 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 10:35:22,842 - src.load - INFO - Tables created/verified successfully.
2025-12-01 10:35:22,842 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 10:35:22,842 - src.load - INFO - Tables truncated.
2025-12-01 10:35:22,842 - src.load - INFO - Inserting into people...
2025-12-01 10:35:22,844 - src.load - INFO - Inserting into hospitals...
2025-12-01 10:35:22,844 - src.load - INFO - Inserting into doctors...
2025-12-01 10:35:22,845 - src.load - INFO - Inserting into conditions...
2025-12-01 10:35:22,845 - src.load - INFO - Inserting into insurance...
2025-12-01 10:35:22,846 - src.load - INFO - Inserting into test_results...
2025-12-01 10:35:22,846 - src.load - INFO - Inserting into admission_types...
2025-12-01 10:35:22,847 - src.load - INFO - Inserting into admission_data...
2025-12-01 10:35:22,856 - src.load - INFO - Inserting into rejects...
2025-12-01 10:35:22,858 - src.load - INFO - Load completed successfully.
2025-12-01 10:35:22,858 - src.load - INFO - Database connection closed. End of load().
2025-12-01 10:35:22,914 - src.load - INFO - Starting load()
2025-12-01 10:35:22,915 - src.load - INFO - Row counts - people=3, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 10:35:22,915 - src.load - INFO - Connecting to database...
2025-12-01 10:35:22,915 - src.load - INFO - Database connection established.
2025-12-01 10:35:22,915 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 10:35:22,915 - src.load - INFO - Tables created/verified successfully.
2025-12-01 10:35:22,915 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 10:35:22,915 - src.load - INFO - Tables truncated.
2025-12-01 10:35:22,916 - src.load - INFO - Inserting into people...
2025-12-01 10:35:22,925 - src.load - WARNING - Invalid age 150 for person Too Old; setting age to NULL before insert
2025-12-01 10:35:22,925 - src.load - INFO - Inserting into hospitals...
2025-12-01 10:35:22,925 - src.load - INFO - Inserting into doctors...
2025-12-01 10:35:22,926 - src.load - INFO - Inserting into conditions...
2025-12-01 10:35:22,927 - src.load - INFO - Inserting into insurance...
2025-12-01 10:35:22,927 - src.load - INFO - Inserting into test_results...
2025-12-01 10:35:22,928 - src.load - INFO - Inserting into admission_types...
2025-12-01 10:35:22,932 - src.load - INFO - Inserting into admission_data...
2025-12-01 10:35:22,948 - src.load - INFO - Inserting into rejects...
2025-12-01 10:35:22,961 - src.load - INFO - Load completed successfully.
2025-12-01 10:35:22,963 - src.load - INFO - Database connection closed. End of load().
2025-12-01 10:35:22,994 - src.load - INFO - Starting load()
2025-12-01 10:35:22,994 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 10:35:22,995 - src.load - INFO - Connecting to database...
2025-12-01 10:35:22,995 - src.load - INFO - Database connection established.
2025-12-01 10:35:22,995 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 10:35:22,996 - src.load - INFO - Tables created/verified successfully.
2025-12-01 10:35:22,996 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 10:35:22,997 - src.load - INFO - Tables truncated.
2025-12-01 10:35:22,997 - src.load - INFO - Inserting into people...
2025-12-01 10:35:23,000 - src.load - ERROR - Failed inserting people row: Pandas(person_id=1, name='Error Person', age=40, gender='M', blood_type='AB+')
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-01 10:35:23,008 - src.load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-01 10:35:23,008 - src.load - INFO - Transaction rolled back due to error.
2025-12-01 10:35:23,009 - src.load - INFO - Database connection closed. End of load().
2025-12-01 10:35:23,018 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-12-01 10:35:23,027 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-12-01 10:35:23,032 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-12-01 10:35:23,041 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-12-01 10:35:23,056 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 10:35:23,060 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-12-01 10:35:23,062 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-12-01 10:35:23,081 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-12-01 10:35:23,083 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-12-01 10:35:23,083 - src.transform - INFO - Merging people into base df...
2025-12-01 10:35:23,087 - src.transform - INFO - Merging doctors into base df...
2025-12-01 10:35:23,154 - src.transform - INFO - Merging conditions into base df...
2025-12-01 10:35:23,201 - src.transform - INFO - Merging insurance into base df...
2025-12-01 10:35:23,224 - src.transform - INFO - Merging test_results into base df...
2025-12-01 10:35:23,227 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 10:35:23,229 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-12-01 10:35:23,237 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 10:35:23,237 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-12-01 10:35:23,237 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-12-01 10:35:23,242 - src.transform - INFO - Starting transform(): input df has 3 rows x 15 columns
2025-12-01 10:35:23,254 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-12-01 10:35:23,256 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-12-01 10:35:23,258 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-12-01 10:35:23,262 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 10:35:23,264 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-12-01 10:35:23,266 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-12-01 10:35:23,268 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-12-01 10:35:23,269 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-12-01 10:35:23,271 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-12-01 10:35:23,271 - src.transform - INFO - Merging people into base df...
2025-12-01 10:35:23,273 - src.transform - INFO - Merging doctors into base df...
2025-12-01 10:35:23,276 - src.transform - INFO - Merging conditions into base df...
2025-12-01 10:35:23,278 - src.transform - INFO - Merging insurance into base df...
2025-12-01 10:35:23,280 - src.transform - INFO - Merging test_results into base df...
2025-12-01 10:35:23,282 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 10:35:23,284 - src.transform - INFO - Finished merges; df is now 3 rows x 27 columns
2025-12-01 10:35:23,289 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 10:35:23,289 - src.transform - INFO - After reject split: 2 valid admissions, 1 rejected rows
2025-12-01 10:35:23,289 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (1, 16)}
2025-12-01 10:35:23,295 - src.transform - INFO - Starting transform(): input df has 1 rows x 14 columns
2025-12-01 10:35:23,296 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-12-01 10:35:38,947 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-12-01 10:35:38,948 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-12-01 10:35:38,957 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-12-01 10:35:38,976 - src.clean - INFO - Standardized string columns where present.
2025-12-01 10:35:38,976 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-12-01 10:35:38,981 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-12-01 10:35:38,982 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-12-01 10:35:38,983 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-12-01 10:35:38,989 - src.clean - INFO - Standardized string columns where present.
2025-12-01 10:35:38,989 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-12-01 10:35:39,020 - src.load - INFO - Starting load()
2025-12-01 10:35:39,021 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 10:35:39,021 - src.load - INFO - Connecting to database...
2025-12-01 10:35:39,022 - src.load - INFO - Database connection established.
2025-12-01 10:35:39,024 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 10:35:39,029 - src.load - INFO - Tables created/verified successfully.
2025-12-01 10:35:39,029 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 10:35:39,029 - src.load - INFO - Tables truncated.
2025-12-01 10:35:39,029 - src.load - INFO - Inserting into people...
2025-12-01 10:35:39,030 - src.load - INFO - Inserting into hospitals...
2025-12-01 10:35:39,031 - src.load - INFO - Inserting into doctors...
2025-12-01 10:35:39,031 - src.load - INFO - Inserting into conditions...
2025-12-01 10:35:39,032 - src.load - INFO - Inserting into insurance...
2025-12-01 10:35:39,032 - src.load - INFO - Inserting into test_results...
2025-12-01 10:35:39,033 - src.load - INFO - Inserting into admission_types...
2025-12-01 10:35:39,033 - src.load - INFO - Inserting into admission_data...
2025-12-01 10:35:39,044 - src.load - INFO - Inserting into rejects...
2025-12-01 10:35:39,046 - src.load - INFO - Load completed successfully.
2025-12-01 10:35:39,046 - src.load - INFO - Database connection closed. End of load().
2025-12-01 10:35:39,061 - src.load - INFO - Starting load()
2025-12-01 10:35:39,061 - src.load - INFO - Row counts - people=3, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 10:35:39,061 - src.load - INFO - Connecting to database...
2025-12-01 10:35:39,062 - src.load - INFO - Database connection established.
2025-12-01 10:35:39,062 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 10:35:39,062 - src.load - INFO - Tables created/verified successfully.
2025-12-01 10:35:39,062 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 10:35:39,062 - src.load - INFO - Tables truncated.
2025-12-01 10:35:39,062 - src.load - INFO - Inserting into people...
2025-12-01 10:35:39,063 - src.load - WARNING - Invalid age 150 for person Too Old; setting age to NULL before insert
2025-12-01 10:35:39,063 - src.load - INFO - Inserting into hospitals...
2025-12-01 10:35:39,063 - src.load - INFO - Inserting into doctors...
2025-12-01 10:35:39,064 - src.load - INFO - Inserting into conditions...
2025-12-01 10:35:39,064 - src.load - INFO - Inserting into insurance...
2025-12-01 10:35:39,065 - src.load - INFO - Inserting into test_results...
2025-12-01 10:35:39,066 - src.load - INFO - Inserting into admission_types...
2025-12-01 10:35:39,067 - src.load - INFO - Inserting into admission_data...
2025-12-01 10:35:39,068 - src.load - INFO - Inserting into rejects...
2025-12-01 10:35:39,070 - src.load - INFO - Load completed successfully.
2025-12-01 10:35:39,070 - src.load - INFO - Database connection closed. End of load().
2025-12-01 10:35:39,079 - src.load - INFO - Starting load()
2025-12-01 10:35:39,080 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 10:35:39,080 - src.load - INFO - Connecting to database...
2025-12-01 10:35:39,080 - src.load - INFO - Database connection established.
2025-12-01 10:35:39,080 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 10:35:39,080 - src.load - INFO - Tables created/verified successfully.
2025-12-01 10:35:39,080 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 10:35:39,081 - src.load - INFO - Tables truncated.
2025-12-01 10:35:39,081 - src.load - INFO - Inserting into people...
2025-12-01 10:35:39,082 - src.load - ERROR - Failed inserting people row: Pandas(person_id=1, name='Error Person', age=40, gender='M', blood_type='AB+')
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-01 10:35:39,093 - src.load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-01 10:35:39,093 - src.load - INFO - Transaction rolled back due to error.
2025-12-01 10:35:39,094 - src.load - INFO - Database connection closed. End of load().
2025-12-01 10:35:39,098 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-12-01 10:35:39,207 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-12-01 10:35:39,211 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-12-01 10:35:39,218 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-12-01 10:35:39,242 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 10:35:39,246 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-12-01 10:35:39,248 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-12-01 10:35:39,280 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-12-01 10:35:39,282 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-12-01 10:35:39,282 - src.transform - INFO - Merging people into base df...
2025-12-01 10:35:39,298 - src.transform - INFO - Merging doctors into base df...
2025-12-01 10:35:39,301 - src.transform - INFO - Merging conditions into base df...
2025-12-01 10:35:39,303 - src.transform - INFO - Merging insurance into base df...
2025-12-01 10:35:39,307 - src.transform - INFO - Merging test_results into base df...
2025-12-01 10:35:39,314 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 10:35:39,316 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-12-01 10:35:39,340 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 10:35:39,341 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-12-01 10:35:39,341 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-12-01 10:35:39,367 - src.transform - INFO - Starting transform(): input df has 3 rows x 15 columns
2025-12-01 10:35:39,369 - src.transform - INFO - Built people_df: 2 rows x 5 columns
2025-12-01 10:35:39,371 - src.transform - INFO - Built doctors_df (pre-hospital merge): 2 rows x 3 columns
2025-12-01 10:35:39,373 - src.transform - INFO - Built hospitals_df: 2 rows x 2 columns
2025-12-01 10:35:39,376 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 10:35:39,386 - src.transform - INFO - Built conditions_df: 2 rows x 2 columns
2025-12-01 10:35:39,389 - src.transform - INFO - Built insurance_df: 1 rows x 2 columns
2025-12-01 10:35:39,391 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-12-01 10:35:39,393 - src.transform - INFO - Built test_results_df: 2 rows x 2 columns
2025-12-01 10:35:39,395 - src.transform - INFO - Built admission_types_df: 2 rows x 2 columns
2025-12-01 10:35:39,395 - src.transform - INFO - Merging people into base df...
2025-12-01 10:35:39,398 - src.transform - INFO - Merging doctors into base df...
2025-12-01 10:35:39,403 - src.transform - INFO - Merging conditions into base df...
2025-12-01 10:35:39,405 - src.transform - INFO - Merging insurance into base df...
2025-12-01 10:35:39,407 - src.transform - INFO - Merging test_results into base df...
2025-12-01 10:35:39,409 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 10:35:39,412 - src.transform - INFO - Finished merges; df is now 3 rows x 27 columns
2025-12-01 10:35:39,418 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 10:35:39,418 - src.transform - INFO - After reject split: 2 valid admissions, 1 rejected rows
2025-12-01 10:35:39,418 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (1, 16)}
2025-12-01 10:35:39,423 - src.transform - INFO - Starting transform(): input df has 1 rows x 14 columns
2025-12-01 10:35:39,423 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-12-01 10:39:51,821 - src.read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-12-01 10:39:51,821 - src.read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-12-01 10:39:52,156 - src.read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-12-01 10:39:52,156 - src.clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-12-01 10:39:52,176 - src.clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-12-01 10:39:52,211 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-12-01 10:39:52,646 - src.clean - INFO - Standardized string columns where present.
2025-12-01 10:39:52,685 - src.clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-12-01 10:39:52,786 - src.clean - INFO - Column billing_amount converted to numeric successfully.
2025-12-01 10:39:52,821 - src.clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-12-01 10:39:52,824 - src.clean - INFO - Age range before validation: min=0.0, max=150.0
2025-12-01 10:39:52,825 - src.clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-12-01 10:39:52,838 - src.clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-12-01 10:39:52,847 - src.clean - INFO - Rounded billing_amount to 2 decimal places.
2025-12-01 10:39:52,874 - src.clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-12-01 10:39:52,916 - src.clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-12-01 10:39:52,916 - src.clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-12-01 10:39:52,917 - src.transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-12-01 10:39:53,046 - src.transform - INFO - Built people_df: 55143 rows x 5 columns
2025-12-01 10:39:53,105 - src.transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-12-01 10:39:53,120 - src.transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-12-01 10:39:53,151 - src.transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-12-01 10:39:53,163 - src.transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-12-01 10:39:53,174 - src.transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-12-01 10:39:53,184 - src.transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-12-01 10:39:53,192 - src.transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-12-01 10:39:53,206 - src.transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-12-01 10:39:53,207 - src.transform - INFO - Merging people into base df...
2025-12-01 10:39:53,311 - src.transform - INFO - Merging doctors into base df...
2025-12-01 10:39:53,373 - src.transform - INFO - Merging conditions into base df...
2025-12-01 10:39:53,430 - src.transform - INFO - Merging insurance into base df...
2025-12-01 10:39:53,597 - src.transform - INFO - Merging test_results into base df...
2025-12-01 10:39:53,663 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 10:39:53,715 - src.transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-12-01 10:39:55,081 - src.transform - INFO - Built admissions_df: 39539 rows x 12 columns
2025-12-01 10:39:55,081 - src.transform - INFO - After reject split: 39539 valid admissions, 17626 rejected rows
2025-12-01 10:39:55,082 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (3, 2), 'admissions': (39539, 12), 'rejects': (17626, 16)}
2025-12-01 10:39:55,093 - src.load - INFO - Starting load()
2025-12-01 10:39:55,093 - src.load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=3, admission_types=4, admissions=39539, rejects=17626
2025-12-01 10:39:55,093 - src.load - INFO - Connecting to database...
2025-12-01 10:39:55,112 - src.load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 37, in load
    conn = psycopg2.connect(db_url)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/psycopg2/__init__.py", line 121, in connect
    dsn = _ext.make_dsn(dsn, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/psycopg2/extensions.py", line 145, in make_dsn
    parse_dsn(dsn)
psycopg2.ProgrammingError: invalid dsn: missing "=" after "${DB_URL}" in connection info string

2025-12-01 10:39:55,127 - src.load - INFO - Database connection closed. End of load().
2025-12-01 10:40:56,621 - src.read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-12-01 10:40:56,621 - src.read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-12-01 10:40:56,952 - src.read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-12-01 10:40:56,953 - src.clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-12-01 10:40:56,969 - src.clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-12-01 10:40:57,010 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-12-01 10:40:57,491 - src.clean - INFO - Standardized string columns where present.
2025-12-01 10:40:57,537 - src.clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-12-01 10:40:57,639 - src.clean - INFO - Column billing_amount converted to numeric successfully.
2025-12-01 10:40:57,674 - src.clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-12-01 10:40:57,674 - src.clean - INFO - Age range before validation: min=0.0, max=150.0
2025-12-01 10:40:57,675 - src.clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-12-01 10:40:57,676 - src.clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-12-01 10:40:57,678 - src.clean - INFO - Rounded billing_amount to 2 decimal places.
2025-12-01 10:40:57,706 - src.clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-12-01 10:40:57,721 - src.clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-12-01 10:40:57,721 - src.clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-12-01 10:40:57,721 - src.transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-12-01 10:40:57,775 - src.transform - INFO - Built people_df: 55143 rows x 5 columns
2025-12-01 10:40:57,816 - src.transform - INFO - Built doctors_df (pre-hospital merge): 51460 rows x 3 columns
2025-12-01 10:40:57,829 - src.transform - INFO - Built hospitals_df: 39008 rows x 2 columns
2025-12-01 10:40:57,973 - src.transform - INFO - Updated doctors_df after hospital merge: 51460 rows x 4 columns
2025-12-01 10:40:57,982 - src.transform - INFO - Built conditions_df: 7 rows x 2 columns
2025-12-01 10:40:57,991 - src.transform - INFO - Built insurance_df: 7 rows x 2 columns
2025-12-01 10:40:58,003 - src.transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-12-01 10:40:58,014 - src.transform - INFO - Built test_results_df: 3 rows x 2 columns
2025-12-01 10:40:58,020 - src.transform - INFO - Built admission_types_df: 4 rows x 2 columns
2025-12-01 10:40:58,023 - src.transform - INFO - Merging people into base df...
2025-12-01 10:40:58,106 - src.transform - INFO - Merging doctors into base df...
2025-12-01 10:40:58,165 - src.transform - INFO - Merging conditions into base df...
2025-12-01 10:40:58,215 - src.transform - INFO - Merging insurance into base df...
2025-12-01 10:40:58,272 - src.transform - INFO - Merging test_results into base df...
2025-12-01 10:40:58,323 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 10:40:58,377 - src.transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-12-01 10:40:59,887 - src.transform - INFO - Built admissions_df: 39539 rows x 12 columns
2025-12-01 10:40:59,888 - src.transform - INFO - After reject split: 39539 valid admissions, 17626 rejected rows
2025-12-01 10:40:59,889 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (55143, 5), 'doctors': (51460, 4), 'hospitals': (39008, 2), 'conditions': (7, 2), 'insurance': (7, 2), 'admission_types': (4, 2), 'test_results': (3, 2), 'admissions': (39539, 12), 'rejects': (17626, 16)}
2025-12-01 10:40:59,913 - src.load - INFO - Starting load()
2025-12-01 10:40:59,915 - src.load - INFO - Row counts - people=55143, hospitals=39008, doctors=51460, conditions=7, insurance=7, test_results=3, admission_types=4, admissions=39539, rejects=17626
2025-12-01 10:40:59,915 - src.load - INFO - Connecting to database...
2025-12-01 10:41:00,093 - src.load - INFO - Database connection established.
2025-12-01 10:41:00,093 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 10:41:00,140 - src.load - INFO - Tables created/verified successfully.
2025-12-01 10:41:00,142 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 10:41:00,366 - src.load - INFO - Tables truncated.
2025-12-01 10:41:00,366 - src.load - INFO - Inserting into people...
2025-12-01 10:41:08,161 - src.load - INFO - Inserting into hospitals...
2025-12-01 10:41:12,969 - src.load - INFO - Inserting into doctors...
2025-12-01 10:41:20,421 - src.load - INFO - Inserting into conditions...
2025-12-01 10:41:20,434 - src.load - INFO - Inserting into insurance...
2025-12-01 10:41:20,450 - src.load - INFO - Inserting into test_results...
2025-12-01 10:41:20,598 - src.load - INFO - Inserting into admission_types...
2025-12-01 10:41:20,623 - src.load - INFO - Inserting into admission_data...
2025-12-01 10:41:31,738 - src.load - INFO - Inserting into rejects...
2025-12-01 10:41:36,221 - src.load - INFO - Load completed successfully.
2025-12-01 10:41:36,221 - src.load - INFO - Database connection closed. End of load().
2025-12-01 10:54:46,990 - src.read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-12-01 10:54:46,990 - src.read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-12-01 10:54:47,344 - src.read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-12-01 10:54:47,344 - src.clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-12-01 10:54:47,359 - src.clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-12-01 10:54:47,380 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-12-01 10:54:47,796 - src.clean - INFO - Standardized string columns where present.
2025-12-01 10:54:47,830 - src.clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-12-01 10:54:47,933 - src.clean - INFO - Column billing_amount converted to numeric successfully.
2025-12-01 10:54:47,979 - src.clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-12-01 10:54:47,980 - src.clean - INFO - Age range before validation: min=0.0, max=150.0
2025-12-01 10:54:47,986 - src.clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-12-01 10:54:47,992 - src.clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-12-01 10:54:47,996 - src.clean - INFO - Rounded billing_amount to 2 decimal places.
2025-12-01 10:54:48,021 - src.clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-12-01 10:54:48,038 - src.clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-12-01 10:54:48,039 - src.clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-12-01 10:54:48,039 - src.transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-12-01 10:54:48,105 - src.transform - INFO - Built people_df (no nulls): 46802 rows x 5 columns
2025-12-01 10:54:48,139 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 46283 rows x 3 columns
2025-12-01 10:54:48,228 - src.transform - INFO - Built hospitals_df (no nulls): 37437 rows x 2 columns
2025-12-01 10:54:48,294 - src.transform - INFO - Updated doctors_df after hospital merge: 46283 rows x 4 columns
2025-12-01 10:54:48,313 - src.transform - INFO - Built conditions_df (no nulls): 6 rows x 2 columns
2025-12-01 10:54:48,340 - src.transform - INFO - Built insurance_df (no nulls): 6 rows x 2 columns
2025-12-01 10:54:48,347 - src.transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-12-01 10:54:48,353 - src.transform - INFO - Built test_results_df (no nulls): 3 rows x 2 columns
2025-12-01 10:54:48,369 - src.transform - INFO - Built admission_types_df (no nulls): 3 rows x 2 columns
2025-12-01 10:54:48,370 - src.transform - INFO - Merging people into base df...
2025-12-01 10:54:48,457 - src.transform - INFO - Merging doctors into base df...
2025-12-01 10:54:48,607 - src.transform - INFO - Merging conditions into base df...
2025-12-01 10:54:48,663 - src.transform - INFO - Merging insurance into base df...
2025-12-01 10:54:48,975 - src.transform - INFO - Merging test_results into base df...
2025-12-01 10:54:49,151 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 10:54:49,193 - src.transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-12-01 10:54:50,761 - src.transform - INFO - Built admissions_df: 25973 rows x 12 columns
2025-12-01 10:54:50,761 - src.transform - INFO - After reject split: 25973 valid admissions, 31192 rejected rows
2025-12-01 10:54:50,761 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (46802, 5), 'doctors': (46283, 4), 'hospitals': (37437, 2), 'conditions': (6, 2), 'insurance': (6, 2), 'admission_types': (3, 2), 'test_results': (3, 2), 'admissions': (25973, 12), 'rejects': (31192, 16)}
2025-12-01 10:54:50,768 - src.load - INFO - Starting load()
2025-12-01 10:54:50,768 - src.load - INFO - Row counts - people=46802, hospitals=37437, doctors=46283, conditions=6, insurance=6, test_results=3, admission_types=3, admissions=25973, rejects=31192
2025-12-01 10:54:50,768 - src.load - INFO - Connecting to database...
2025-12-01 10:54:50,952 - src.load - INFO - Database connection established.
2025-12-01 10:54:50,953 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 10:54:51,122 - src.load - INFO - Tables created/verified successfully.
2025-12-01 10:54:51,122 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 10:54:51,164 - src.load - INFO - Tables truncated.
2025-12-01 10:54:51,164 - src.load - INFO - Inserting into people...
2025-12-01 10:54:56,840 - src.load - INFO - Inserting into hospitals...
2025-12-01 10:55:00,963 - src.load - INFO - Inserting into doctors...
2025-12-01 10:55:07,082 - src.load - INFO - Inserting into conditions...
2025-12-01 10:55:07,084 - src.load - INFO - Inserting into insurance...
2025-12-01 10:55:07,098 - src.load - INFO - Inserting into test_results...
2025-12-01 10:55:07,101 - src.load - INFO - Inserting into admission_types...
2025-12-01 10:55:07,102 - src.load - INFO - Inserting into admission_data...
2025-12-01 10:55:14,016 - src.load - INFO - Inserting into rejects...
2025-12-01 10:55:19,857 - src.load - INFO - Load completed successfully.
2025-12-01 10:55:19,858 - src.load - INFO - Database connection closed. End of load().
2025-12-01 15:19:35,180 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-12-01 15:19:35,181 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-12-01 15:19:35,199 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-12-01 15:19:35,274 - src.clean - INFO - Standardized string columns where present.
2025-12-01 15:19:35,274 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-12-01 15:19:35,279 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-12-01 15:19:35,279 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-12-01 15:19:35,280 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-12-01 15:19:35,285 - src.clean - INFO - Standardized string columns where present.
2025-12-01 15:19:35,285 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-12-01 15:19:35,405 - src.load - INFO - Starting load()
2025-12-01 15:19:35,406 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 15:19:35,407 - src.load - INFO - Connecting to database...
2025-12-01 15:19:35,407 - src.load - INFO - Database connection established.
2025-12-01 15:19:35,407 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 15:19:35,407 - src.load - INFO - Tables created/verified successfully.
2025-12-01 15:19:35,407 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 15:19:35,407 - src.load - INFO - Tables truncated.
2025-12-01 15:19:35,407 - src.load - INFO - Inserting into people...
2025-12-01 15:19:35,409 - src.load - INFO - Inserting into hospitals...
2025-12-01 15:19:35,410 - src.load - INFO - Inserting into doctors...
2025-12-01 15:19:35,411 - src.load - INFO - Inserting into conditions...
2025-12-01 15:19:35,412 - src.load - INFO - Inserting into insurance...
2025-12-01 15:19:35,412 - src.load - INFO - Inserting into test_results...
2025-12-01 15:19:35,413 - src.load - INFO - Inserting into admission_types...
2025-12-01 15:19:35,414 - src.load - INFO - Inserting into admission_data...
2025-12-01 15:19:35,417 - src.load - INFO - Inserting into rejects...
2025-12-01 15:19:35,421 - src.load - INFO - Load completed successfully.
2025-12-01 15:19:35,422 - src.load - INFO - Database connection closed. End of load().
2025-12-01 15:19:35,443 - src.load - INFO - Starting load()
2025-12-01 15:19:35,443 - src.load - INFO - Row counts - people=3, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 15:19:35,443 - src.load - INFO - Connecting to database...
2025-12-01 15:19:35,444 - src.load - INFO - Database connection established.
2025-12-01 15:19:35,444 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 15:19:35,444 - src.load - INFO - Tables created/verified successfully.
2025-12-01 15:19:35,444 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 15:19:35,444 - src.load - INFO - Tables truncated.
2025-12-01 15:19:35,444 - src.load - INFO - Inserting into people...
2025-12-01 15:19:35,445 - src.load - WARNING - Invalid age 150 for person Too Old; setting age to NULL before insert
2025-12-01 15:19:35,446 - src.load - INFO - Inserting into hospitals...
2025-12-01 15:19:35,446 - src.load - INFO - Inserting into doctors...
2025-12-01 15:19:35,447 - src.load - INFO - Inserting into conditions...
2025-12-01 15:19:35,448 - src.load - INFO - Inserting into insurance...
2025-12-01 15:19:35,448 - src.load - INFO - Inserting into test_results...
2025-12-01 15:19:35,449 - src.load - INFO - Inserting into admission_types...
2025-12-01 15:19:35,449 - src.load - INFO - Inserting into admission_data...
2025-12-01 15:19:35,452 - src.load - INFO - Inserting into rejects...
2025-12-01 15:19:35,455 - src.load - INFO - Load completed successfully.
2025-12-01 15:19:35,455 - src.load - INFO - Database connection closed. End of load().
2025-12-01 15:19:35,471 - src.load - INFO - Starting load()
2025-12-01 15:19:35,471 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 15:19:35,471 - src.load - INFO - Connecting to database...
2025-12-01 15:19:35,471 - src.load - INFO - Database connection established.
2025-12-01 15:19:35,472 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 15:19:35,472 - src.load - INFO - Tables created/verified successfully.
2025-12-01 15:19:35,472 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 15:19:35,472 - src.load - INFO - Tables truncated.
2025-12-01 15:19:35,472 - src.load - INFO - Inserting into people...
2025-12-01 15:19:35,474 - src.load - ERROR - Failed inserting people row: Pandas(person_id=1, name='Error Person', age=40, gender='M', blood_type='AB+')
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-01 15:19:35,477 - src.load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-01 15:19:35,478 - src.load - INFO - Transaction rolled back due to error.
2025-12-01 15:19:35,478 - src.load - INFO - Database connection closed. End of load().
2025-12-01 15:19:35,488 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-12-01 15:19:35,528 - src.transform - INFO - Built people_df (no nulls): 2 rows x 5 columns
2025-12-01 15:19:35,532 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 2 rows x 3 columns
2025-12-01 15:19:35,536 - src.transform - INFO - Built hospitals_df (no nulls): 2 rows x 2 columns
2025-12-01 15:19:35,552 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 15:19:35,556 - src.transform - INFO - Built conditions_df (no nulls): 2 rows x 2 columns
2025-12-01 15:19:35,559 - src.transform - INFO - Built insurance_df (no nulls): 1 rows x 2 columns
2025-12-01 15:19:35,600 - src.transform - INFO - Built test_results_df (no nulls): 2 rows x 2 columns
2025-12-01 15:19:35,604 - src.transform - INFO - Built admission_types_df (no nulls): 2 rows x 2 columns
2025-12-01 15:19:35,604 - src.transform - INFO - Merging people into base df...
2025-12-01 15:19:35,606 - src.transform - INFO - Merging doctors into base df...
2025-12-01 15:19:35,609 - src.transform - INFO - Merging conditions into base df...
2025-12-01 15:19:35,611 - src.transform - INFO - Merging insurance into base df...
2025-12-01 15:19:35,621 - src.transform - INFO - Merging test_results into base df...
2025-12-01 15:19:35,624 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 15:19:35,626 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-12-01 15:19:35,638 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 15:19:35,638 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-12-01 15:19:35,638 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-12-01 15:19:35,644 - src.transform - INFO - Starting transform(): input df has 3 rows x 15 columns
2025-12-01 15:19:35,647 - src.transform - INFO - Built people_df (no nulls): 2 rows x 5 columns
2025-12-01 15:19:35,650 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 2 rows x 3 columns
2025-12-01 15:19:35,657 - src.transform - INFO - Built hospitals_df (no nulls): 2 rows x 2 columns
2025-12-01 15:19:35,661 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 15:19:35,664 - src.transform - INFO - Built conditions_df (no nulls): 2 rows x 2 columns
2025-12-01 15:19:35,667 - src.transform - INFO - Built insurance_df (no nulls): 1 rows x 2 columns
2025-12-01 15:19:35,669 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-12-01 15:19:35,670 - src.transform - INFO - Built test_results_df (no nulls): 2 rows x 2 columns
2025-12-01 15:19:35,674 - src.transform - INFO - Built admission_types_df (no nulls): 2 rows x 2 columns
2025-12-01 15:19:35,674 - src.transform - INFO - Merging people into base df...
2025-12-01 15:19:35,677 - src.transform - INFO - Merging doctors into base df...
2025-12-01 15:19:35,680 - src.transform - INFO - Merging conditions into base df...
2025-12-01 15:19:35,682 - src.transform - INFO - Merging insurance into base df...
2025-12-01 15:19:35,684 - src.transform - INFO - Merging test_results into base df...
2025-12-01 15:19:35,686 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 15:19:35,688 - src.transform - INFO - Finished merges; df is now 3 rows x 27 columns
2025-12-01 15:19:35,695 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 15:19:35,695 - src.transform - INFO - After reject split: 2 valid admissions, 1 rejected rows
2025-12-01 15:19:35,695 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (1, 16)}
2025-12-01 15:19:35,699 - src.transform - INFO - Starting transform(): input df has 1 rows x 14 columns
2025-12-01 15:19:35,703 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-12-01 15:20:16,306 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-12-01 15:20:16,308 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-12-01 15:20:16,343 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-12-01 15:20:16,476 - src.clean - INFO - Standardized string columns where present.
2025-12-01 15:20:16,476 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-12-01 15:20:16,480 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-12-01 15:20:16,480 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-12-01 15:20:16,481 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-12-01 15:20:16,490 - src.clean - INFO - Standardized string columns where present.
2025-12-01 15:20:16,490 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-12-01 15:20:16,528 - src.load - INFO - Starting load()
2025-12-01 15:20:16,528 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 15:20:16,528 - src.load - INFO - Connecting to database...
2025-12-01 15:20:16,528 - src.load - INFO - Database connection established.
2025-12-01 15:20:16,528 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 15:20:16,529 - src.load - INFO - Tables created/verified successfully.
2025-12-01 15:20:16,529 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 15:20:16,529 - src.load - INFO - Tables truncated.
2025-12-01 15:20:16,529 - src.load - INFO - Inserting into people...
2025-12-01 15:20:16,530 - src.load - INFO - Inserting into hospitals...
2025-12-01 15:20:16,530 - src.load - INFO - Inserting into doctors...
2025-12-01 15:20:16,531 - src.load - INFO - Inserting into conditions...
2025-12-01 15:20:16,532 - src.load - INFO - Inserting into insurance...
2025-12-01 15:20:16,532 - src.load - INFO - Inserting into test_results...
2025-12-01 15:20:16,533 - src.load - INFO - Inserting into admission_types...
2025-12-01 15:20:16,534 - src.load - INFO - Inserting into admission_data...
2025-12-01 15:20:16,542 - src.load - INFO - Inserting into rejects...
2025-12-01 15:20:16,544 - src.load - INFO - Load completed successfully.
2025-12-01 15:20:16,544 - src.load - INFO - Database connection closed. End of load().
2025-12-01 15:20:16,552 - src.load - INFO - Starting load()
2025-12-01 15:20:16,552 - src.load - INFO - Row counts - people=3, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 15:20:16,552 - src.load - INFO - Connecting to database...
2025-12-01 15:20:16,553 - src.load - INFO - Database connection established.
2025-12-01 15:20:16,553 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 15:20:16,553 - src.load - INFO - Tables created/verified successfully.
2025-12-01 15:20:16,553 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 15:20:16,554 - src.load - INFO - Tables truncated.
2025-12-01 15:20:16,554 - src.load - INFO - Inserting into people...
2025-12-01 15:20:16,555 - src.load - WARNING - Invalid age 150 for person Too Old; setting age to NULL before insert
2025-12-01 15:20:16,555 - src.load - INFO - Inserting into hospitals...
2025-12-01 15:20:16,556 - src.load - INFO - Inserting into doctors...
2025-12-01 15:20:16,556 - src.load - INFO - Inserting into conditions...
2025-12-01 15:20:16,557 - src.load - INFO - Inserting into insurance...
2025-12-01 15:20:16,558 - src.load - INFO - Inserting into test_results...
2025-12-01 15:20:16,558 - src.load - INFO - Inserting into admission_types...
2025-12-01 15:20:16,559 - src.load - INFO - Inserting into admission_data...
2025-12-01 15:20:16,561 - src.load - INFO - Inserting into rejects...
2025-12-01 15:20:16,564 - src.load - INFO - Load completed successfully.
2025-12-01 15:20:16,565 - src.load - INFO - Database connection closed. End of load().
2025-12-01 15:20:16,572 - src.load - INFO - Starting load()
2025-12-01 15:20:16,572 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 15:20:16,572 - src.load - INFO - Connecting to database...
2025-12-01 15:20:16,572 - src.load - INFO - Database connection established.
2025-12-01 15:20:16,572 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 15:20:16,573 - src.load - INFO - Tables created/verified successfully.
2025-12-01 15:20:16,573 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 15:20:16,573 - src.load - INFO - Tables truncated.
2025-12-01 15:20:16,573 - src.load - INFO - Inserting into people...
2025-12-01 15:20:16,574 - src.load - ERROR - Failed inserting people row: Pandas(person_id=1, name='Error Person', age=40, gender='M', blood_type='AB+')
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-01 15:20:16,577 - src.load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-01 15:20:16,578 - src.load - INFO - Transaction rolled back due to error.
2025-12-01 15:20:16,578 - src.load - INFO - Database connection closed. End of load().
2025-12-01 15:20:16,583 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-12-01 15:20:16,613 - src.transform - INFO - Built people_df (no nulls): 2 rows x 5 columns
2025-12-01 15:20:16,619 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 2 rows x 3 columns
2025-12-01 15:20:16,622 - src.transform - INFO - Built hospitals_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:16,640 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 15:20:16,646 - src.transform - INFO - Built conditions_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:16,649 - src.transform - INFO - Built insurance_df (no nulls): 1 rows x 2 columns
2025-12-01 15:20:16,652 - src.transform - INFO - Built test_results_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:16,656 - src.transform - INFO - Built admission_types_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:16,656 - src.transform - INFO - Merging people into base df...
2025-12-01 15:20:16,659 - src.transform - INFO - Merging doctors into base df...
2025-12-01 15:20:16,663 - src.transform - INFO - Merging conditions into base df...
2025-12-01 15:20:16,664 - src.transform - INFO - Merging insurance into base df...
2025-12-01 15:20:16,673 - src.transform - INFO - Merging test_results into base df...
2025-12-01 15:20:16,675 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 15:20:16,677 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-12-01 15:20:16,690 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 15:20:16,690 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-12-01 15:20:16,690 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-12-01 15:20:16,698 - src.transform - INFO - Starting transform(): input df has 3 rows x 15 columns
2025-12-01 15:20:16,707 - src.transform - INFO - Built people_df (no nulls): 2 rows x 5 columns
2025-12-01 15:20:16,710 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 2 rows x 3 columns
2025-12-01 15:20:16,714 - src.transform - INFO - Built hospitals_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:16,717 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 15:20:16,721 - src.transform - INFO - Built conditions_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:16,724 - src.transform - INFO - Built insurance_df (no nulls): 1 rows x 2 columns
2025-12-01 15:20:16,726 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-12-01 15:20:16,727 - src.transform - INFO - Built test_results_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:16,730 - src.transform - INFO - Built admission_types_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:16,730 - src.transform - INFO - Merging people into base df...
2025-12-01 15:20:16,734 - src.transform - INFO - Merging doctors into base df...
2025-12-01 15:20:16,738 - src.transform - INFO - Merging conditions into base df...
2025-12-01 15:20:16,739 - src.transform - INFO - Merging insurance into base df...
2025-12-01 15:20:16,741 - src.transform - INFO - Merging test_results into base df...
2025-12-01 15:20:16,743 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 15:20:16,745 - src.transform - INFO - Finished merges; df is now 3 rows x 27 columns
2025-12-01 15:20:16,752 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 15:20:16,752 - src.transform - INFO - After reject split: 2 valid admissions, 1 rejected rows
2025-12-01 15:20:16,753 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (1, 16)}
2025-12-01 15:20:16,757 - src.transform - INFO - Starting transform(): input df has 1 rows x 14 columns
2025-12-01 15:20:16,757 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-12-01 15:20:53,925 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-12-01 15:20:53,927 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-12-01 15:20:53,937 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-12-01 15:20:53,956 - src.clean - INFO - Standardized string columns where present.
2025-12-01 15:20:53,956 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-12-01 15:20:53,960 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-12-01 15:20:53,961 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-12-01 15:20:53,961 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-12-01 15:20:53,974 - src.clean - INFO - Standardized string columns where present.
2025-12-01 15:20:53,975 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-12-01 15:20:53,992 - src.load - INFO - Starting load()
2025-12-01 15:20:53,995 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 15:20:53,995 - src.load - INFO - Connecting to database...
2025-12-01 15:20:53,996 - src.load - INFO - Database connection established.
2025-12-01 15:20:53,996 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 15:20:53,996 - src.load - INFO - Tables created/verified successfully.
2025-12-01 15:20:53,996 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 15:20:53,996 - src.load - INFO - Tables truncated.
2025-12-01 15:20:53,996 - src.load - INFO - Inserting into people...
2025-12-01 15:20:53,997 - src.load - INFO - Inserting into hospitals...
2025-12-01 15:20:53,998 - src.load - INFO - Inserting into doctors...
2025-12-01 15:20:54,001 - src.load - INFO - Inserting into conditions...
2025-12-01 15:20:54,002 - src.load - INFO - Inserting into insurance...
2025-12-01 15:20:54,012 - src.load - INFO - Inserting into test_results...
2025-12-01 15:20:54,012 - src.load - INFO - Inserting into admission_types...
2025-12-01 15:20:54,013 - src.load - INFO - Inserting into admission_data...
2025-12-01 15:20:54,016 - src.load - INFO - Inserting into rejects...
2025-12-01 15:20:54,019 - src.load - INFO - Load completed successfully.
2025-12-01 15:20:54,019 - src.load - INFO - Database connection closed. End of load().
2025-12-01 15:20:54,037 - src.load - INFO - Starting load()
2025-12-01 15:20:54,038 - src.load - INFO - Row counts - people=3, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 15:20:54,039 - src.load - INFO - Connecting to database...
2025-12-01 15:20:54,039 - src.load - INFO - Database connection established.
2025-12-01 15:20:54,039 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 15:20:54,039 - src.load - INFO - Tables created/verified successfully.
2025-12-01 15:20:54,039 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 15:20:54,039 - src.load - INFO - Tables truncated.
2025-12-01 15:20:54,039 - src.load - INFO - Inserting into people...
2025-12-01 15:20:54,041 - src.load - WARNING - Invalid age 150 for person Too Old; setting age to NULL before insert
2025-12-01 15:20:54,044 - src.load - INFO - Inserting into hospitals...
2025-12-01 15:20:54,044 - src.load - INFO - Inserting into doctors...
2025-12-01 15:20:54,045 - src.load - INFO - Inserting into conditions...
2025-12-01 15:20:54,046 - src.load - INFO - Inserting into insurance...
2025-12-01 15:20:54,046 - src.load - INFO - Inserting into test_results...
2025-12-01 15:20:54,046 - src.load - INFO - Inserting into admission_types...
2025-12-01 15:20:54,047 - src.load - INFO - Inserting into admission_data...
2025-12-01 15:20:54,049 - src.load - INFO - Inserting into rejects...
2025-12-01 15:20:54,050 - src.load - INFO - Load completed successfully.
2025-12-01 15:20:54,051 - src.load - INFO - Database connection closed. End of load().
2025-12-01 15:20:54,063 - src.load - INFO - Starting load()
2025-12-01 15:20:54,063 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-01 15:20:54,064 - src.load - INFO - Connecting to database...
2025-12-01 15:20:54,064 - src.load - INFO - Database connection established.
2025-12-01 15:20:54,064 - src.load - INFO - Creating tables if they do not exist...
2025-12-01 15:20:54,064 - src.load - INFO - Tables created/verified successfully.
2025-12-01 15:20:54,064 - src.load - INFO - Truncating tables and resetting identities...
2025-12-01 15:20:54,064 - src.load - INFO - Tables truncated.
2025-12-01 15:20:54,064 - src.load - INFO - Inserting into people...
2025-12-01 15:20:54,065 - src.load - ERROR - Failed inserting people row: Pandas(person_id=1, name='Error Person', age=40, gender='M', blood_type='AB+')
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-01 15:20:54,068 - src.load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-01 15:20:54,079 - src.load - INFO - Transaction rolled back due to error.
2025-12-01 15:20:54,079 - src.load - INFO - Database connection closed. End of load().
2025-12-01 15:20:54,102 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-12-01 15:20:54,118 - src.transform - INFO - Built people_df (no nulls): 2 rows x 5 columns
2025-12-01 15:20:54,128 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 2 rows x 3 columns
2025-12-01 15:20:54,133 - src.transform - INFO - Built hospitals_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:54,264 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 15:20:54,270 - src.transform - INFO - Built conditions_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:54,276 - src.transform - INFO - Built insurance_df (no nulls): 1 rows x 2 columns
2025-12-01 15:20:54,281 - src.transform - INFO - Built test_results_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:54,296 - src.transform - INFO - Built admission_types_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:54,296 - src.transform - INFO - Merging people into base df...
2025-12-01 15:20:54,323 - src.transform - INFO - Merging doctors into base df...
2025-12-01 15:20:54,327 - src.transform - INFO - Merging conditions into base df...
2025-12-01 15:20:54,328 - src.transform - INFO - Merging insurance into base df...
2025-12-01 15:20:54,332 - src.transform - INFO - Merging test_results into base df...
2025-12-01 15:20:54,334 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 15:20:54,336 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-12-01 15:20:54,344 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 15:20:54,344 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-12-01 15:20:54,344 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-12-01 15:20:54,360 - src.transform - INFO - Starting transform(): input df has 3 rows x 15 columns
2025-12-01 15:20:54,365 - src.transform - INFO - Built people_df (no nulls): 2 rows x 5 columns
2025-12-01 15:20:54,379 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 2 rows x 3 columns
2025-12-01 15:20:54,414 - src.transform - INFO - Built hospitals_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:54,440 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-01 15:20:54,451 - src.transform - INFO - Built conditions_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:54,460 - src.transform - INFO - Built insurance_df (no nulls): 1 rows x 2 columns
2025-12-01 15:20:54,465 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-12-01 15:20:54,472 - src.transform - INFO - Built test_results_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:54,480 - src.transform - INFO - Built admission_types_df (no nulls): 2 rows x 2 columns
2025-12-01 15:20:54,480 - src.transform - INFO - Merging people into base df...
2025-12-01 15:20:54,485 - src.transform - INFO - Merging doctors into base df...
2025-12-01 15:20:54,490 - src.transform - INFO - Merging conditions into base df...
2025-12-01 15:20:54,506 - src.transform - INFO - Merging insurance into base df...
2025-12-01 15:20:54,594 - src.transform - INFO - Merging test_results into base df...
2025-12-01 15:20:54,650 - src.transform - INFO - Merging admission_types into base df...
2025-12-01 15:20:55,510 - src.transform - INFO - Finished merges; df is now 3 rows x 27 columns
2025-12-01 15:20:55,895 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-01 15:20:55,919 - src.transform - INFO - After reject split: 2 valid admissions, 1 rejected rows
2025-12-01 15:20:55,919 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (1, 16)}
2025-12-01 15:20:55,925 - src.transform - INFO - Starting transform(): input df has 1 rows x 14 columns
2025-12-01 15:20:55,926 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-12-04 09:19:13,212 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-12-04 09:19:13,214 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-12-04 09:19:13,231 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-12-04 09:19:13,359 - src.clean - INFO - Standardized string columns where present.
2025-12-04 09:19:13,359 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-12-04 09:19:13,364 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-12-04 09:19:13,364 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-12-04 09:19:13,365 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-12-04 09:19:13,371 - src.clean - INFO - Standardized string columns where present.
2025-12-04 09:19:13,371 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-12-04 09:19:13,387 - src.load - INFO - Starting load()
2025-12-04 09:19:13,387 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-04 09:19:13,387 - src.load - INFO - Connecting to database...
2025-12-04 09:19:13,388 - src.load - INFO - Database connection established.
2025-12-04 09:19:13,388 - src.load - INFO - Creating tables if they do not exist...
2025-12-04 09:19:13,388 - src.load - INFO - Tables created/verified successfully.
2025-12-04 09:19:13,388 - src.load - INFO - Truncating tables and resetting identities...
2025-12-04 09:19:13,388 - src.load - INFO - Tables truncated.
2025-12-04 09:19:13,388 - src.load - INFO - Inserting into people...
2025-12-04 09:19:13,389 - src.load - INFO - Inserting into hospitals...
2025-12-04 09:19:13,390 - src.load - INFO - Inserting into doctors...
2025-12-04 09:19:13,390 - src.load - INFO - Inserting into conditions...
2025-12-04 09:19:13,391 - src.load - INFO - Inserting into insurance...
2025-12-04 09:19:13,391 - src.load - INFO - Inserting into test_results...
2025-12-04 09:19:13,392 - src.load - INFO - Inserting into admission_types...
2025-12-04 09:19:13,392 - src.load - INFO - Inserting into admission_data...
2025-12-04 09:19:13,396 - src.load - INFO - Inserting into rejects...
2025-12-04 09:19:13,398 - src.load - INFO - Load completed successfully.
2025-12-04 09:19:13,398 - src.load - INFO - Database connection closed. End of load().
2025-12-04 09:19:13,405 - src.load - INFO - Starting load()
2025-12-04 09:19:13,405 - src.load - INFO - Row counts - people=3, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-04 09:19:13,405 - src.load - INFO - Connecting to database...
2025-12-04 09:19:13,405 - src.load - INFO - Database connection established.
2025-12-04 09:19:13,405 - src.load - INFO - Creating tables if they do not exist...
2025-12-04 09:19:13,405 - src.load - INFO - Tables created/verified successfully.
2025-12-04 09:19:13,405 - src.load - INFO - Truncating tables and resetting identities...
2025-12-04 09:19:13,406 - src.load - INFO - Tables truncated.
2025-12-04 09:19:13,406 - src.load - INFO - Inserting into people...
2025-12-04 09:19:13,409 - src.load - WARNING - Invalid age 150 for person Too Old; setting age to NULL before insert
2025-12-04 09:19:13,410 - src.load - INFO - Inserting into hospitals...
2025-12-04 09:19:13,410 - src.load - INFO - Inserting into doctors...
2025-12-04 09:19:13,411 - src.load - INFO - Inserting into conditions...
2025-12-04 09:19:13,411 - src.load - INFO - Inserting into insurance...
2025-12-04 09:19:13,412 - src.load - INFO - Inserting into test_results...
2025-12-04 09:19:13,416 - src.load - INFO - Inserting into admission_types...
2025-12-04 09:19:13,423 - src.load - INFO - Inserting into admission_data...
2025-12-04 09:19:13,436 - src.load - INFO - Inserting into rejects...
2025-12-04 09:19:13,439 - src.load - INFO - Load completed successfully.
2025-12-04 09:19:13,439 - src.load - INFO - Database connection closed. End of load().
2025-12-04 09:19:13,451 - src.load - INFO - Starting load()
2025-12-04 09:19:13,452 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-04 09:19:13,452 - src.load - INFO - Connecting to database...
2025-12-04 09:19:13,452 - src.load - INFO - Database connection established.
2025-12-04 09:19:13,452 - src.load - INFO - Creating tables if they do not exist...
2025-12-04 09:19:13,452 - src.load - INFO - Tables created/verified successfully.
2025-12-04 09:19:13,453 - src.load - INFO - Truncating tables and resetting identities...
2025-12-04 09:19:13,453 - src.load - INFO - Tables truncated.
2025-12-04 09:19:13,453 - src.load - INFO - Inserting into people...
2025-12-04 09:19:13,454 - src.load - ERROR - Failed inserting people row: Pandas(person_id=1, name='Error Person', age=40, gender='M', blood_type='AB+')
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-04 09:19:13,460 - src.load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-04 09:19:13,460 - src.load - INFO - Transaction rolled back due to error.
2025-12-04 09:19:13,464 - src.load - INFO - Database connection closed. End of load().
2025-12-04 09:19:13,471 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-12-04 09:19:13,522 - src.transform - INFO - Built people_df (no nulls): 2 rows x 5 columns
2025-12-04 09:19:13,526 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 2 rows x 3 columns
2025-12-04 09:19:13,548 - src.transform - INFO - Built hospitals_df (no nulls): 2 rows x 2 columns
2025-12-04 09:19:13,603 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-04 09:19:13,607 - src.transform - INFO - Built conditions_df (no nulls): 2 rows x 2 columns
2025-12-04 09:19:13,611 - src.transform - INFO - Built insurance_df (no nulls): 1 rows x 2 columns
2025-12-04 09:19:13,614 - src.transform - INFO - Built test_results_df (no nulls): 2 rows x 2 columns
2025-12-04 09:19:13,618 - src.transform - INFO - Built admission_types_df (no nulls): 2 rows x 2 columns
2025-12-04 09:19:13,618 - src.transform - INFO - Merging people into base df...
2025-12-04 09:19:13,634 - src.transform - INFO - Merging doctors into base df...
2025-12-04 09:19:13,637 - src.transform - INFO - Merging conditions into base df...
2025-12-04 09:19:13,639 - src.transform - INFO - Merging insurance into base df...
2025-12-04 09:19:13,649 - src.transform - INFO - Merging test_results into base df...
2025-12-04 09:19:13,651 - src.transform - INFO - Merging admission_types into base df...
2025-12-04 09:19:13,654 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-12-04 09:19:13,684 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-04 09:19:13,684 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-12-04 09:19:13,684 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-12-04 09:19:13,690 - src.transform - INFO - Starting transform(): input df has 3 rows x 15 columns
2025-12-04 09:19:13,694 - src.transform - INFO - Built people_df (no nulls): 2 rows x 5 columns
2025-12-04 09:19:13,698 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 2 rows x 3 columns
2025-12-04 09:19:13,701 - src.transform - INFO - Built hospitals_df (no nulls): 2 rows x 2 columns
2025-12-04 09:19:13,704 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-04 09:19:13,707 - src.transform - INFO - Built conditions_df (no nulls): 2 rows x 2 columns
2025-12-04 09:19:13,711 - src.transform - INFO - Built insurance_df (no nulls): 1 rows x 2 columns
2025-12-04 09:19:13,714 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-12-04 09:19:13,716 - src.transform - INFO - Built test_results_df (no nulls): 2 rows x 2 columns
2025-12-04 09:19:13,719 - src.transform - INFO - Built admission_types_df (no nulls): 2 rows x 2 columns
2025-12-04 09:19:13,720 - src.transform - INFO - Merging people into base df...
2025-12-04 09:19:13,722 - src.transform - INFO - Merging doctors into base df...
2025-12-04 09:19:13,725 - src.transform - INFO - Merging conditions into base df...
2025-12-04 09:19:13,727 - src.transform - INFO - Merging insurance into base df...
2025-12-04 09:19:13,729 - src.transform - INFO - Merging test_results into base df...
2025-12-04 09:19:13,731 - src.transform - INFO - Merging admission_types into base df...
2025-12-04 09:19:13,733 - src.transform - INFO - Finished merges; df is now 3 rows x 27 columns
2025-12-04 09:19:13,740 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-04 09:19:13,740 - src.transform - INFO - After reject split: 2 valid admissions, 1 rejected rows
2025-12-04 09:19:13,740 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (1, 16)}
2025-12-04 09:19:13,744 - src.transform - INFO - Starting transform(): input df has 1 rows x 14 columns
2025-12-04 09:19:13,746 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-12-04 09:23:14,725 - src.clean - INFO - Starting clean(): input df has 2 rows x 3 columns
2025-12-04 09:23:14,728 - src.clean - INFO - Normalized column names. Before: [' Name ', 'GENDER', 'hospitAL'] | After: ['name', 'gender', 'hospital']
2025-12-04 09:23:14,736 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender', 'hospital']
2025-12-04 09:23:14,805 - src.clean - INFO - Standardized string columns where present.
2025-12-04 09:23:14,806 - src.clean - INFO - clean() completed. Output df has 2 rows x 3 columns
2025-12-04 09:23:14,812 - src.clean - INFO - Starting clean(): input df has 1 rows x 2 columns
2025-12-04 09:23:14,812 - src.clean - INFO - Normalized column names. Before: ['NAME', 'GENDER'] | After: ['name', 'gender']
2025-12-04 09:23:14,813 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'gender']
2025-12-04 09:23:14,818 - src.clean - INFO - Standardized string columns where present.
2025-12-04 09:23:14,818 - src.clean - INFO - clean() completed. Output df has 1 rows x 2 columns
2025-12-04 09:23:14,863 - src.load - INFO - Starting load()
2025-12-04 09:23:14,863 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-04 09:23:14,863 - src.load - INFO - Connecting to database...
2025-12-04 09:23:14,863 - src.load - INFO - Database connection established.
2025-12-04 09:23:14,863 - src.load - INFO - Creating tables if they do not exist...
2025-12-04 09:23:14,863 - src.load - INFO - Tables created/verified successfully.
2025-12-04 09:23:14,864 - src.load - INFO - Truncating tables and resetting identities...
2025-12-04 09:23:14,864 - src.load - INFO - Tables truncated.
2025-12-04 09:23:14,864 - src.load - INFO - Inserting into people...
2025-12-04 09:23:14,865 - src.load - INFO - Inserting into hospitals...
2025-12-04 09:23:14,865 - src.load - INFO - Inserting into doctors...
2025-12-04 09:23:14,866 - src.load - INFO - Inserting into conditions...
2025-12-04 09:23:14,866 - src.load - INFO - Inserting into insurance...
2025-12-04 09:23:14,867 - src.load - INFO - Inserting into test_results...
2025-12-04 09:23:14,867 - src.load - INFO - Inserting into admission_types...
2025-12-04 09:23:14,868 - src.load - INFO - Inserting into admission_data...
2025-12-04 09:23:14,875 - src.load - INFO - Inserting into rejects...
2025-12-04 09:23:14,878 - src.load - INFO - Load completed successfully.
2025-12-04 09:23:14,878 - src.load - INFO - Database connection closed. End of load().
2025-12-04 09:23:14,884 - src.load - INFO - Starting load()
2025-12-04 09:23:14,884 - src.load - INFO - Row counts - people=3, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-04 09:23:14,885 - src.load - INFO - Connecting to database...
2025-12-04 09:23:14,885 - src.load - INFO - Database connection established.
2025-12-04 09:23:14,885 - src.load - INFO - Creating tables if they do not exist...
2025-12-04 09:23:14,885 - src.load - INFO - Tables created/verified successfully.
2025-12-04 09:23:14,885 - src.load - INFO - Truncating tables and resetting identities...
2025-12-04 09:23:14,885 - src.load - INFO - Tables truncated.
2025-12-04 09:23:14,885 - src.load - INFO - Inserting into people...
2025-12-04 09:23:14,886 - src.load - WARNING - Invalid age 150 for person Too Old; setting age to NULL before insert
2025-12-04 09:23:14,887 - src.load - INFO - Inserting into hospitals...
2025-12-04 09:23:14,887 - src.load - INFO - Inserting into doctors...
2025-12-04 09:23:14,888 - src.load - INFO - Inserting into conditions...
2025-12-04 09:23:14,888 - src.load - INFO - Inserting into insurance...
2025-12-04 09:23:14,888 - src.load - INFO - Inserting into test_results...
2025-12-04 09:23:14,889 - src.load - INFO - Inserting into admission_types...
2025-12-04 09:23:14,890 - src.load - INFO - Inserting into admission_data...
2025-12-04 09:23:14,891 - src.load - INFO - Inserting into rejects...
2025-12-04 09:23:14,894 - src.load - INFO - Load completed successfully.
2025-12-04 09:23:14,897 - src.load - INFO - Database connection closed. End of load().
2025-12-04 09:23:14,919 - src.load - INFO - Starting load()
2025-12-04 09:23:14,920 - src.load - INFO - Row counts - people=1, hospitals=1, doctors=1, conditions=1, insurance=1, test_results=1, admission_types=1, admissions=1, rejects=1
2025-12-04 09:23:14,920 - src.load - INFO - Connecting to database...
2025-12-04 09:23:14,920 - src.load - INFO - Database connection established.
2025-12-04 09:23:14,920 - src.load - INFO - Creating tables if they do not exist...
2025-12-04 09:23:14,920 - src.load - INFO - Tables created/verified successfully.
2025-12-04 09:23:14,920 - src.load - INFO - Truncating tables and resetting identities...
2025-12-04 09:23:14,920 - src.load - INFO - Tables truncated.
2025-12-04 09:23:14,920 - src.load - INFO - Inserting into people...
2025-12-04 09:23:14,922 - src.load - ERROR - Failed inserting people row: Pandas(person_id=1, name='Error Person', age=40, gender='M', blood_type='AB+')
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-04 09:23:14,933 - src.load - ERROR - Error in load() while working with the database.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/load.py", line 173, in load
    cur.execute(
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/tests/test_load.py", line 18, in execute
    raise psycopg2.Error("Simulated DB error")
psycopg2.Error: Simulated DB error
2025-12-04 09:23:14,934 - src.load - INFO - Transaction rolled back due to error.
2025-12-04 09:23:14,934 - src.load - INFO - Database connection closed. End of load().
2025-12-04 09:23:14,965 - src.read - INFO - Reading CSV file from /private/var/folders/45/mms0wwj51255z_fqrdsfrqzh0000gn/T/pytest-of-mattmurno/pytest-0/test_read_csv_success0/test.csv
2025-12-04 09:23:14,973 - src.read - INFO - Successfully read CSV: 2 rows x 2 columns
2025-12-04 09:23:14,987 - src.read - INFO - Reading JSON file from /private/var/folders/45/mms0wwj51255z_fqrdsfrqzh0000gn/T/pytest-of-mattmurno/pytest-0/test_read_json_success0/test.json
2025-12-04 09:23:15,002 - src.read - INFO - Successfully read JSON: 2 rows x 2 columns
2025-12-04 09:23:15,013 - src.read - INFO - Starting read() for type=csv, path=/private/var/folders/45/mms0wwj51255z_fqrdsfrqzh0000gn/T/pytest-of-mattmurno/pytest-0/test_read_dispatches_to_csv0/test.csv
2025-12-04 09:23:15,013 - src.read - INFO - Reading CSV file from /private/var/folders/45/mms0wwj51255z_fqrdsfrqzh0000gn/T/pytest-of-mattmurno/pytest-0/test_read_dispatches_to_csv0/test.csv
2025-12-04 09:23:15,016 - src.read - INFO - Successfully read CSV: 2 rows x 2 columns
2025-12-04 09:23:15,022 - src.read - INFO - Starting read() for type=json, path=/private/var/folders/45/mms0wwj51255z_fqrdsfrqzh0000gn/T/pytest-of-mattmurno/pytest-0/test_read_dispatches_to_json0/test.json
2025-12-04 09:23:15,022 - src.read - INFO - Reading JSON file from /private/var/folders/45/mms0wwj51255z_fqrdsfrqzh0000gn/T/pytest-of-mattmurno/pytest-0/test_read_dispatches_to_json0/test.json
2025-12-04 09:23:15,032 - src.read - INFO - Successfully read JSON: 2 rows x 2 columns
2025-12-04 09:23:15,038 - src.read - INFO - Reading CSV file from /private/var/folders/45/mms0wwj51255z_fqrdsfrqzh0000gn/T/pytest-of-mattmurno/pytest-0/test_read_csv_missing_file_rai0/does_not_exist.csv
2025-12-04 09:23:15,038 - src.read - ERROR - Failed to read CSV file from /private/var/folders/45/mms0wwj51255z_fqrdsfrqzh0000gn/T/pytest-of-mattmurno/pytest-0/test_read_csv_missing_file_rai0/does_not_exist.csv
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/read.py", line 11, in read_csv
    df = pd.read_csv(filepath)
         ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '/private/var/folders/45/mms0wwj51255z_fqrdsfrqzh0000gn/T/pytest-of-mattmurno/pytest-0/test_read_csv_missing_file_rai0/does_not_exist.csv'
2025-12-04 09:23:15,055 - src.read - INFO - Reading JSON file from /private/var/folders/45/mms0wwj51255z_fqrdsfrqzh0000gn/T/pytest-of-mattmurno/pytest-0/test_read_json_missing_file_ra0/does_not_exist.json
2025-12-04 09:23:15,055 - src.read - ERROR - Failed to read JSON file from /private/var/folders/45/mms0wwj51255z_fqrdsfrqzh0000gn/T/pytest-of-mattmurno/pytest-0/test_read_json_missing_file_ra0/does_not_exist.json
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/read.py", line 22, in read_json
    df = pd.read_json(filepath)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/io/json/_json.py", line 791, in read_json
    json_reader = JsonReader(
                  ^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/io/json/_json.py", line 904, in __init__
    data = self._get_data_from_filepath(filepath_or_buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/io/json/_json.py", line 960, in _get_data_from_filepath
    raise FileNotFoundError(f"File {filepath_or_buffer} does not exist")
FileNotFoundError: File /private/var/folders/45/mms0wwj51255z_fqrdsfrqzh0000gn/T/pytest-of-mattmurno/pytest-0/test_read_json_missing_file_ra0/does_not_exist.json does not exist
2025-12-04 09:23:15,064 - src.read - INFO - Starting read() for type=xml, path=some/path/file.xml
2025-12-04 09:23:15,064 - src.read - ERROR - Unsupported source type in read(): xml
2025-12-04 09:23:15,072 - src.transform - INFO - Starting transform(): input df has 2 rows x 15 columns
2025-12-04 09:23:15,097 - src.transform - INFO - Built people_df (no nulls): 2 rows x 5 columns
2025-12-04 09:23:15,103 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 2 rows x 3 columns
2025-12-04 09:23:15,107 - src.transform - INFO - Built hospitals_df (no nulls): 2 rows x 2 columns
2025-12-04 09:23:15,178 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-04 09:23:15,182 - src.transform - INFO - Built conditions_df (no nulls): 2 rows x 2 columns
2025-12-04 09:23:15,198 - src.transform - INFO - Built insurance_df (no nulls): 1 rows x 2 columns
2025-12-04 09:23:15,237 - src.transform - INFO - Built test_results_df (no nulls): 2 rows x 2 columns
2025-12-04 09:23:15,241 - src.transform - INFO - Built admission_types_df (no nulls): 2 rows x 2 columns
2025-12-04 09:23:15,242 - src.transform - INFO - Merging people into base df...
2025-12-04 09:23:15,245 - src.transform - INFO - Merging doctors into base df...
2025-12-04 09:23:15,248 - src.transform - INFO - Merging conditions into base df...
2025-12-04 09:23:15,250 - src.transform - INFO - Merging insurance into base df...
2025-12-04 09:23:15,256 - src.transform - INFO - Merging test_results into base df...
2025-12-04 09:23:15,258 - src.transform - INFO - Merging admission_types into base df...
2025-12-04 09:23:15,260 - src.transform - INFO - Finished merges; df is now 2 rows x 27 columns
2025-12-04 09:23:15,300 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-04 09:23:15,300 - src.transform - INFO - After reject split: 2 valid admissions, 0 rejected rows
2025-12-04 09:23:15,300 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (0, 16)}
2025-12-04 09:23:15,306 - src.transform - INFO - Starting transform(): input df has 3 rows x 15 columns
2025-12-04 09:23:15,310 - src.transform - INFO - Built people_df (no nulls): 2 rows x 5 columns
2025-12-04 09:23:15,313 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 2 rows x 3 columns
2025-12-04 09:23:15,317 - src.transform - INFO - Built hospitals_df (no nulls): 2 rows x 2 columns
2025-12-04 09:23:15,320 - src.transform - INFO - Updated doctors_df after hospital merge: 2 rows x 4 columns
2025-12-04 09:23:15,324 - src.transform - INFO - Built conditions_df (no nulls): 2 rows x 2 columns
2025-12-04 09:23:15,327 - src.transform - INFO - Built insurance_df (no nulls): 1 rows x 2 columns
2025-12-04 09:23:15,330 - src.transform - WARNING - test_results_df: 1 invalid or null result_label value(s) dropped before dimension build
2025-12-04 09:23:15,331 - src.transform - INFO - Built test_results_df (no nulls): 2 rows x 2 columns
2025-12-04 09:23:15,335 - src.transform - INFO - Built admission_types_df (no nulls): 2 rows x 2 columns
2025-12-04 09:23:15,335 - src.transform - INFO - Merging people into base df...
2025-12-04 09:23:15,338 - src.transform - INFO - Merging doctors into base df...
2025-12-04 09:23:15,342 - src.transform - INFO - Merging conditions into base df...
2025-12-04 09:23:15,345 - src.transform - INFO - Merging insurance into base df...
2025-12-04 09:23:15,347 - src.transform - INFO - Merging test_results into base df...
2025-12-04 09:23:15,349 - src.transform - INFO - Merging admission_types into base df...
2025-12-04 09:23:15,351 - src.transform - INFO - Finished merges; df is now 3 rows x 27 columns
2025-12-04 09:23:15,358 - src.transform - INFO - Built admissions_df: 2 rows x 12 columns
2025-12-04 09:23:15,358 - src.transform - INFO - After reject split: 2 valid admissions, 1 rejected rows
2025-12-04 09:23:15,358 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (2, 5), 'doctors': (2, 4), 'hospitals': (2, 2), 'conditions': (2, 2), 'insurance': (1, 2), 'admission_types': (2, 2), 'test_results': (2, 2), 'admissions': (2, 12), 'rejects': (1, 16)}
2025-12-04 09:23:15,362 - src.transform - INFO - Starting transform(): input df has 1 rows x 14 columns
2025-12-04 09:23:15,363 - src.transform - ERROR - transform() failed.
Traceback (most recent call last):
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/src/transform.py", line 16, in transform
    df[["name", "age", "gender", "blood_type"]]
    ~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "/Users/mattmurno/Desktop/Revature training files/etl_proj/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['name'] not in index"
2025-12-04 09:42:15,815 - src.read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-12-04 09:42:15,816 - src.read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-12-04 09:42:16,278 - src.read - INFO - Successfully read CSV: 57165 rows x 15 columns
2025-12-04 09:42:16,278 - src.clean - INFO - Starting clean(): input df has 57165 rows x 15 columns
2025-12-04 09:42:16,295 - src.clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-12-04 09:42:16,305 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-12-04 09:42:16,789 - src.clean - INFO - Standardized string columns where present.
2025-12-04 09:42:16,821 - src.clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-12-04 09:42:17,048 - src.clean - INFO - Column billing_amount converted to numeric successfully.
2025-12-04 09:42:17,124 - src.clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-12-04 09:42:17,127 - src.clean - INFO - Age range before validation: min=0.0, max=150.0
2025-12-04 09:42:17,129 - src.clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-12-04 09:42:17,130 - src.clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-12-04 09:42:17,132 - src.clean - INFO - Rounded billing_amount to 2 decimal places.
2025-12-04 09:42:17,185 - src.clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-12-04 09:42:17,201 - src.clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-12-04 09:42:17,201 - src.clean - INFO - clean() completed. Output df has 57165 rows x 15 columns
2025-12-04 09:42:17,201 - src.transform - INFO - Starting transform(): input df has 57165 rows x 15 columns
2025-12-04 09:42:17,267 - src.transform - INFO - Built people_df (no nulls): 46802 rows x 5 columns
2025-12-04 09:42:17,308 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 46283 rows x 3 columns
2025-12-04 09:42:17,333 - src.transform - INFO - Built hospitals_df (no nulls): 37437 rows x 2 columns
2025-12-04 09:42:17,377 - src.transform - INFO - Updated doctors_df after hospital merge: 46283 rows x 4 columns
2025-12-04 09:42:17,397 - src.transform - INFO - Built conditions_df (no nulls): 6 rows x 2 columns
2025-12-04 09:42:17,408 - src.transform - INFO - Built insurance_df (no nulls): 6 rows x 2 columns
2025-12-04 09:42:17,426 - src.transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-12-04 09:42:17,431 - src.transform - INFO - Built test_results_df (no nulls): 3 rows x 2 columns
2025-12-04 09:42:17,461 - src.transform - INFO - Built admission_types_df (no nulls): 3 rows x 2 columns
2025-12-04 09:42:17,462 - src.transform - INFO - Merging people into base df...
2025-12-04 09:42:17,600 - src.transform - INFO - Merging doctors into base df...
2025-12-04 09:42:17,671 - src.transform - INFO - Merging conditions into base df...
2025-12-04 09:42:17,749 - src.transform - INFO - Merging insurance into base df...
2025-12-04 09:42:17,817 - src.transform - INFO - Merging test_results into base df...
2025-12-04 09:42:17,881 - src.transform - INFO - Merging admission_types into base df...
2025-12-04 09:42:17,945 - src.transform - INFO - Finished merges; df is now 57165 rows x 27 columns
2025-12-04 09:42:19,284 - src.transform - INFO - Built admissions_df: 25973 rows x 12 columns
2025-12-04 09:42:19,285 - src.transform - INFO - After reject split: 25973 valid admissions, 31192 rejected rows
2025-12-04 09:42:19,285 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (46802, 5), 'doctors': (46283, 4), 'hospitals': (37437, 2), 'conditions': (6, 2), 'insurance': (6, 2), 'admission_types': (3, 2), 'test_results': (3, 2), 'admissions': (25973, 12), 'rejects': (31192, 16)}
2025-12-04 09:42:19,291 - src.load - INFO - Starting load()
2025-12-04 09:42:19,291 - src.load - INFO - Row counts - people=46802, hospitals=37437, doctors=46283, conditions=6, insurance=6, test_results=3, admission_types=3, admissions=25973, rejects=31192
2025-12-04 09:42:19,291 - src.load - INFO - Connecting to database...
2025-12-04 09:42:19,525 - src.load - INFO - Database connection established.
2025-12-04 09:42:19,525 - src.load - INFO - Creating tables if they do not exist...
2025-12-04 09:42:19,597 - src.load - INFO - Tables created/verified successfully.
2025-12-04 09:42:19,597 - src.load - INFO - Truncating tables and resetting identities...
2025-12-04 09:42:19,872 - src.load - INFO - Tables truncated.
2025-12-04 09:42:19,872 - src.load - INFO - Inserting into people...
2025-12-04 09:42:25,731 - src.load - INFO - Inserting into hospitals...
2025-12-04 09:42:29,408 - src.load - INFO - Inserting into doctors...
2025-12-04 09:42:35,077 - src.load - INFO - Inserting into conditions...
2025-12-04 09:42:35,081 - src.load - INFO - Inserting into insurance...
2025-12-04 09:42:35,124 - src.load - INFO - Inserting into test_results...
2025-12-04 09:42:35,145 - src.load - INFO - Inserting into admission_types...
2025-12-04 09:42:35,174 - src.load - INFO - Inserting into admission_data...
2025-12-04 09:42:41,517 - src.load - INFO - Inserting into rejects...
2025-12-04 09:42:46,809 - src.load - INFO - Load completed successfully.
2025-12-04 09:42:46,809 - src.load - INFO - Database connection closed. End of load().
2025-12-04 09:45:05,851 - src.read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-12-04 09:45:05,852 - src.read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-12-04 09:45:06,082 - src.read - INFO - Successfully read CSV: 57166 rows x 15 columns
2025-12-04 09:45:06,082 - src.clean - INFO - Starting clean(): input df has 57166 rows x 15 columns
2025-12-04 09:45:06,099 - src.clean - INFO - Normalized column names. Before: ['Name', 'Age', 'Gender', 'Blood Type', 'Medical Condition', 'Date of Admission', 'Doctor', 'Hospital', 'Insurance Provider', 'Billing Amount', 'Room Number', 'Admission Type', 'Discharge Date', 'Medication', 'Test Results'] | After: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'billing_amount', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-12-04 09:45:06,110 - src.clean - INFO - Stripping whitespace from string columns: ['name', 'age', 'gender', 'blood_type', 'medical_condition', 'date_of_admission', 'doctor', 'hospital', 'insurance_provider', 'room_number', 'admission_type', 'discharge_date', 'medication', 'test_results']
2025-12-04 09:45:06,525 - src.clean - INFO - Standardized string columns where present.
2025-12-04 09:45:06,666 - src.clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-12-04 09:45:06,756 - src.clean - INFO - Column billing_amount converted to numeric successfully.
2025-12-04 09:45:06,803 - src.clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-12-04 09:45:06,804 - src.clean - INFO - Age range before validation: min=0.0, max=150.0
2025-12-04 09:45:06,806 - src.clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-12-04 09:45:06,807 - src.clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-12-04 09:45:06,811 - src.clean - INFO - Rounded billing_amount to 2 decimal places.
2025-12-04 09:45:06,845 - src.clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-12-04 09:45:06,883 - src.clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-12-04 09:45:06,883 - src.clean - INFO - clean() completed. Output df has 57166 rows x 15 columns
2025-12-04 09:45:06,883 - src.transform - INFO - Starting transform(): input df has 57166 rows x 15 columns
2025-12-04 09:45:07,039 - src.transform - INFO - Built people_df (no nulls): 46803 rows x 5 columns
2025-12-04 09:45:07,114 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 46283 rows x 3 columns
2025-12-04 09:45:07,171 - src.transform - INFO - Built hospitals_df (no nulls): 37437 rows x 2 columns
2025-12-04 09:45:07,224 - src.transform - INFO - Updated doctors_df after hospital merge: 46283 rows x 4 columns
2025-12-04 09:45:07,370 - src.transform - INFO - Built conditions_df (no nulls): 6 rows x 2 columns
2025-12-04 09:45:07,414 - src.transform - INFO - Built insurance_df (no nulls): 6 rows x 2 columns
2025-12-04 09:45:07,436 - src.transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-12-04 09:45:07,460 - src.transform - INFO - Built test_results_df (no nulls): 3 rows x 2 columns
2025-12-04 09:45:07,516 - src.transform - INFO - Built admission_types_df (no nulls): 3 rows x 2 columns
2025-12-04 09:45:07,516 - src.transform - INFO - Merging people into base df...
2025-12-04 09:45:07,621 - src.transform - INFO - Merging doctors into base df...
2025-12-04 09:45:07,720 - src.transform - INFO - Merging conditions into base df...
2025-12-04 09:45:07,797 - src.transform - INFO - Merging insurance into base df...
2025-12-04 09:45:07,856 - src.transform - INFO - Merging test_results into base df...
2025-12-04 09:45:07,924 - src.transform - INFO - Merging admission_types into base df...
2025-12-04 09:45:07,987 - src.transform - INFO - Finished merges; df is now 57166 rows x 27 columns
2025-12-04 09:45:09,326 - src.transform - INFO - Built admissions_df: 25974 rows x 12 columns
2025-12-04 09:45:09,326 - src.transform - INFO - After reject split: 25974 valid admissions, 31192 rejected rows
2025-12-04 09:45:09,326 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (46803, 5), 'doctors': (46283, 4), 'hospitals': (37437, 2), 'conditions': (6, 2), 'insurance': (6, 2), 'admission_types': (3, 2), 'test_results': (3, 2), 'admissions': (25974, 12), 'rejects': (31192, 16)}
2025-12-04 09:45:09,333 - src.load - INFO - Starting load()
2025-12-04 09:45:09,333 - src.load - INFO - Row counts - people=46803, hospitals=37437, doctors=46283, conditions=6, insurance=6, test_results=3, admission_types=3, admissions=25974, rejects=31192
2025-12-04 09:45:09,333 - src.load - INFO - Connecting to database...
2025-12-04 09:45:09,490 - src.load - INFO - Database connection established.
2025-12-04 09:45:09,490 - src.load - INFO - Creating tables if they do not exist...
2025-12-04 09:45:09,496 - src.load - INFO - Tables created/verified successfully.
2025-12-04 09:45:09,496 - src.load - INFO - Truncating tables and resetting identities...
2025-12-04 09:45:09,579 - src.load - INFO - Tables truncated.
2025-12-04 09:45:09,579 - src.load - INFO - Inserting into people...
2025-12-04 09:45:14,487 - src.load - INFO - Inserting into hospitals...
2025-12-04 09:45:18,208 - src.load - INFO - Inserting into doctors...
2025-12-04 09:45:23,808 - src.load - INFO - Inserting into conditions...
2025-12-04 09:45:23,810 - src.load - INFO - Inserting into insurance...
2025-12-04 09:45:23,813 - src.load - INFO - Inserting into test_results...
2025-12-04 09:45:23,816 - src.load - INFO - Inserting into admission_types...
2025-12-04 09:45:23,830 - src.load - INFO - Inserting into admission_data...
2025-12-04 09:45:29,954 - src.load - INFO - Inserting into rejects...
2025-12-04 09:45:34,072 - src.load - INFO - Load completed successfully.
2025-12-04 09:45:34,072 - src.load - INFO - Database connection closed. End of load().
2025-12-04 10:06:44,466 - src.read - INFO - Starting read() for type=csv, path=data/healthcare_dataset_dirty.csv
2025-12-04 10:06:44,466 - src.read - INFO - Reading CSV file from data/healthcare_dataset_dirty.csv
2025-12-04 10:06:44,831 - src.read - INFO - Successfully read CSV: 57166 rows x 15 columns
2025-12-04 10:06:44,831 - src.clean - INFO - Starting clean(): input df has 57166 rows x 15 columns
2025-12-04 10:06:45,541 - src.clean - INFO - Standardized string columns where present.
2025-12-04 10:06:45,603 - src.clean - WARNING - Column age: 285 value(s) could not be converted to numeric and were set to NaN
2025-12-04 10:06:45,721 - src.clean - INFO - Column billing_amount converted to numeric successfully.
2025-12-04 10:06:45,774 - src.clean - WARNING - Column room_number: 394 value(s) could not be converted to numeric and were set to NaN
2025-12-04 10:06:45,776 - src.clean - INFO - Age range before validation: min=0.0, max=150.0
2025-12-04 10:06:45,778 - src.clean - WARNING - Age: 144 value(s) outside valid range (0–120); setting to NA
2025-12-04 10:06:45,779 - src.clean - INFO - Room_number range before validation: min=101.0, max=500.0
2025-12-04 10:06:45,794 - src.clean - INFO - Rounded billing_amount to 2 decimal places.
2025-12-04 10:06:45,961 - src.clean - WARNING - Column date_of_admission: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-12-04 10:06:46,035 - src.clean - WARNING - Column discharge_date: 2858 value(s) could not be parsed as datetime and were set to NaT
2025-12-04 10:06:46,035 - src.clean - INFO - clean() completed. Output df has 57166 rows x 15 columns
2025-12-04 10:06:46,038 - src.transform - INFO - Starting transform(): input df has 57166 rows x 15 columns
2025-12-04 10:06:46,117 - src.transform - INFO - Built people_df (no nulls): 46803 rows x 5 columns
2025-12-04 10:06:46,153 - src.transform - INFO - Built doctors_df (pre-hospital merge, no nulls): 46283 rows x 3 columns
2025-12-04 10:06:46,294 - src.transform - INFO - Built hospitals_df (no nulls): 37437 rows x 2 columns
2025-12-04 10:06:46,322 - src.transform - INFO - Updated doctors_df after hospital merge: 46283 rows x 4 columns
2025-12-04 10:06:46,385 - src.transform - INFO - Built conditions_df (no nulls): 6 rows x 2 columns
2025-12-04 10:06:46,413 - src.transform - INFO - Built insurance_df (no nulls): 6 rows x 2 columns
2025-12-04 10:06:46,423 - src.transform - WARNING - test_results_df: 2839 invalid or null result_label value(s) dropped before dimension build
2025-12-04 10:06:46,431 - src.transform - INFO - Built test_results_df (no nulls): 3 rows x 2 columns
2025-12-04 10:06:46,452 - src.transform - INFO - Built admission_types_df (no nulls): 3 rows x 2 columns
2025-12-04 10:06:47,053 - src.transform - INFO - Finished merges; df is now 57166 rows x 27 columns
2025-12-04 10:06:48,416 - src.transform - INFO - Built admissions_df: 25974 rows x 12 columns
2025-12-04 10:06:48,416 - src.transform - INFO - After reject split: 25974 valid admissions, 31192 rejected rows
2025-12-04 10:06:48,416 - src.transform - INFO - transform() completed successfully. Output tables: {'people': (46803, 5), 'doctors': (46283, 4), 'hospitals': (37437, 2), 'conditions': (6, 2), 'insurance': (6, 2), 'admission_types': (3, 2), 'test_results': (3, 2), 'admissions': (25974, 12), 'rejects': (31192, 16)}
2025-12-04 10:06:48,421 - src.load - INFO - Starting load()
2025-12-04 10:06:48,421 - src.load - INFO - Row counts - people=46803, hospitals=37437, doctors=46283, conditions=6, insurance=6, test_results=3, admission_types=3, admissions=25974, rejects=31192
2025-12-04 10:06:48,421 - src.load - INFO - Connecting to database...
2025-12-04 10:06:48,521 - src.load - INFO - Database connection established.
2025-12-04 10:06:48,521 - src.load - INFO - Creating tables if they do not exist...
2025-12-04 10:06:48,554 - src.load - INFO - Tables created/verified successfully.
2025-12-04 10:06:48,554 - src.load - INFO - Truncating tables and resetting identities...
2025-12-04 10:06:48,757 - src.load - INFO - Tables truncated.
2025-12-04 10:07:23,293 - src.load - INFO - Load completed successfully.
2025-12-04 10:07:23,293 - src.load - INFO - Database connection closed. End of load().
